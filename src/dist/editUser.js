!function(t){var e={};function i(a){if(e[a])return e[a].exports;var n=e[a]={i:a,l:!1,exports:{}};return t[a].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(a,n,function(e){return t[e]}.bind(null,n));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=95)}([,,,,function(t,e,i){"use strict";i.d(e,"d",(function(){return a})),i.d(e,"e",(function(){return r})),i.d(e,"c",(function(){return o})),i.d(e,"b",(function(){return c})),i.d(e,"a",(function(){return l}));const a=t=>{if(!t)return[];const e=[];return"string"==typeof t?e.push(...Array.prototype.slice.call(document.querySelectorAll(t))):Array.isArray(t)?t.forEach(t=>{"string"==typeof t?e.push(...Array.prototype.slice.call(document.querySelectorAll(t))):e.push(t)}):e.push(t),e},n=[],r=(t,e,i)=>{!!n.find(i=>i.element===t&&i.type===e)||(t.addEventListener(e,i),n.push({element:t,type:e}))},s=t=>{if(window.requestAnimationFrame)return window.requestAnimationFrame(t);setTimeout(()=>{t(0)},100)},o=(t,e)=>new Promise(i=>{s(()=>{const a=e.parentElement,n=e.getBoundingClientRect();if(!a)return;const r=a.getBoundingClientRect();n.height<n.width?(e.style.height=r.height+"px",e.style.width="auto"):(e.style.width=r.width+"px",e.style.height="auto"),s(()=>{const a=e.getBoundingClientRect();a.height>r.height?(e.style.height=r.height+"px",e.style.width="auto"):a.width>r.width&&(e.style.width=r.width+"px",e.style.height="auto"),s(()=>{const e=t.uppload.container.querySelector(".uppload-effect");e&&(e.style.opacity="1"),i()})})})}),c=(t,e)=>new Promise(i=>{const a=URL.createObjectURL(t),n=document.createElement("canvas"),s=document.createElement("img"),o=e.maxSize||[e.maxWidth||1/0,e.maxHeight||1/0];s.src=a,s.onload=()=>{const a=e.compressionToMime||"image/jpeg",r=e.compression||1,c=s.width/s.height;s.width>o[0]&&(s.width=o[0],s.height=s.width*(1/c)),s.height>o[1]&&(s.height=o[1],s.width=s.height*c),n.width=s.width,n.height=s.height;const h=n.getContext("2d");if(!h)return i(t);h.clearRect(0,0,n.width,n.height),h.drawImage(s,0,0,n.width,n.height),l(n,a,r).then(e=>{if(e)return i(e);i(t)})},r(s,"error",()=>i(t))}),l=(t,e,i)=>new Promise((a,n)=>{const r=t.getContext("2d");let s=!1;if(r)try{const e=r.getImageData(0,0,t.width,t.height).data;for(let t=0;t<e.length;t+=4)e[t+3]<255&&(s=!0)}catch(t){}if(s&&"image/webp"!==e&&(e=void 0,i=void 0),"function"==typeof t.toBlob)t.toBlob(t=>{t&&a(t),n(new Error("errors.image_error"))},e,i);else if("function"==typeof t.toDataURL){const n=t.toDataURL(e,i);a((t=>{const e=atob(t.split(",")[1]),i=t.split(",")[0].split(":")[1].split(";")[0],a=new ArrayBuffer(e.length),n=new Uint8Array(a);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return new Blob([a],{type:i})})(n))}else n(new Error("errors.image_error"))})},,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var a=i(17),n=i(20),r=i(26),s=i(4),o=i(16);const c=(t,e)=>(t.name=`${e}-import-${Math.random().toString(36).slice(2)}`,t);class l extends a.a{constructor(){super(...arguments),this.loading=!1,this.exampleURL="",this.validator=()=>!0,this.template=({translate:t})=>`\n      <div class="microlink-container">\n      <form class="microlink-search-form">\n        <div class="service-icon">${Object(r.a)(this.icon,this)}</div>\n        <label>\n          <span>${t(`services.${this.name}.label`)||t("services.microlink.label",[t(`services.${this.name}.title`)||this.name,t(`services.${this.name}.type`)||t("services.microlink.type")])}</span>\n          <input class="microlink-search-input" type="url" placeholder="${t(`services.${this.name}.placeholder`)||t("services.microlink.placeholder",[t(`services.${this.name}.title`)||this.name,t(`services.${this.name}.type`)||t("services.microlink.type")])||""}" required>\n        </label>\n        <button type="submit" style="background: ${this.color}">${t(`services.${this.name}.button`)||t("services.microlink.button",t(`services.${this.name}.title`)||this.name)}</button></form><button class="need-help-link"><span>${t("needHelp")}</span aria-hidden="true"><span>?</span></button></div>\n    <div class="uppload-loader microlink-loader">\n    <div></div>\n    <p>${t(`services.${this.name}.loading`)||t("services.microlink.loading",t(`services.${this.name}.title`)||this.name)||t("fetching",t(`services.${this.name}.title`))}</p>\n  </div>`,this.handlers=t=>{const e=t.uppload.container.querySelector(".microlink-search-form");e&&Object(s.e)(e,"submit",e=>{e.preventDefault();const i=t.uppload.container.querySelector(".microlink-search-input");if(i){const e=i.value;if(!this.validator(e))return t.handle(new Error("errors.invalid_url"));this.loading=!0,this.update(t),"screenshot"===this.name?Object(n.b)(`https://api.microlink.io?url=${encodeURIComponent(e)}&screenshot=true&meta=false&embed=screenshot.url`).then(e=>t.next(c(Object(o.a)(e),this.name))).catch(e=>t.handle(e)).then(()=>this.loading=!1):"url"===this.name?Object(n.b)(e).then(e=>t.next(c(Object(o.a)(e),this.name))).catch(e=>t.handle(e)):Object(n.a)("https://api.microlink.io/?url="+encodeURIComponent(e)).then(t=>{if(!t.data.image||!t.data.image.url)throw new Error("errors.response_not_ok");return t.data.image.url}).then(t=>Object(n.b)(t)).then(e=>t.next(c(Object(o.a)(e),this.name))).catch(e=>t.handle(e))}return!1});const i=t.uppload.container.querySelector(".need-help-link");i&&Object(s.e)(i,"click",()=>t.showHelp("/services/"+(-1!==["url","screenshot"].indexOf(this.name)?this.name:"import-from-web-service/"+this.name)))}}update(t){const e=t.uppload.container.querySelector(".microlink-loader"),i=t.uppload.container.querySelector(".microlink-container");i&&(i.style.display=this.loading?"none":""),e&&(e.style.display=this.loading?"flex":"none")}}},,,,function(t,e,i){"use strict";i.d(e,"a",(function(){return r})),i.d(e,"b",(function(){return s}));let a={};const n=t=>{const e={};for(const i in t)if(t.hasOwnProperty(i))if("object"==typeof t[i]){const a=n(t[i]);for(const t in a)a.hasOwnProperty(t)&&(e[i+"."+t]=a[t])}else e[i]=t[i];return e},r=t=>{a=n(t)},s=(t,e)=>{try{let i=a[t];return"string"==typeof e&&(e=[e]),e&&e.forEach((t,e)=>{i=i.replace(`$${e+1}$`,t)}),a.helper&&"function"==typeof a.helper&&(i=a.helper(i)),i}catch(t){return""}}},,function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var a=i(18),n=i(4);class r extends a.a{constructor(){super(...arguments),this.canvas=document.createElement("canvas"),this.originalfileURL="",this.originalFile={blob:new Blob},this.cssFilter="",this.max=10,this.unit="px",this.value=0,this.supports=()=>{var t;return!(!this.canvas.getContext||!this.canvas.getContext("2d")||"string"!=typeof(null===(t=this.canvas.getContext("2d"))||void 0===t?void 0:t.filter))},this.template=({file:t,translate:e})=>{const i=URL.createObjectURL(t.blob);return this.originalfileURL=i,this.originalFile=t,`\n      <div class="uppload-hue-image">\n        <img style="width: 20px" alt="" src="${i}">\n      </div>\n      <div class="settings">\n        <input type="range" value="${this.value}" min="0" max="${this.max}">\n        <span class="value"><span>0</span>${e("units."+this.unit)||this.unit}</span>\n      </div>\n    `},this.handlers=t=>{const e=t.uppload.container.querySelector(".uppload-hue-image img");e&&Object(n.c)(t,e).then(()=>{const e=t.uppload.container.querySelector(".settings input[type='range']");e&&Object(n.e)(e,"change",this.update.bind(this,t))})}}imageToCanvasBlob(t,e){return t.uppload.emitter.emit("processing"),new Promise(i=>{this.canvas=document.createElement("canvas");const a=document.createElement("img");a.src=this.originalfileURL,a.onload=()=>{this.canvas.width=a.width,this.canvas.height=a.height;const r=this.canvas.getContext("2d");r&&(r.clearRect(0,0,this.canvas.width,this.canvas.height),r.filter=e,r.drawImage(a,0,0),Object(n.a)(this.canvas).then(e=>(t.uppload.emitter.emit("process"),i(e))))}})}update(t){let e=0;const i=t.uppload.container.querySelector(".settings input[type='range']");i&&(e=parseInt(i.value));const a=t.uppload.container.querySelector(".settings .value span");a&&(a.innerHTML=e.toString());const n=t.uppload.container.querySelector(".uppload-hue-image img");n&&this.imageToCanvasBlob(t,`${this.cssFilter}(${i.value}${this.unit})`).then(e=>{if(!e)return;this.originalFile.blob=e,t.next(this.originalFile);const i=URL.createObjectURL(e);n.setAttribute("src",i)})}}},,function(t,e,i){"use strict";i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return n}));const a=(t,e,i,a)=>({name:e,blob:t,lastModified:a,type:i}),n=t=>{const e=t.blob;return t.lastModified=t.lastModified||new Date,((t,e,i)=>{try{return new File([t],e||"file_name",{lastModified:(i||new Date).getTime(),type:t.type})}catch(e){return t}})(e,t.name,t.lastModified)}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));class a{constructor(){this.type="service",this.name="",this.invisible=!1,this.noRecolor=!1,this.icon="",this.color="#333",this.template=()=>"",this.handlers=()=>{},this.stop=()=>{},this.supports=()=>!0}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));class a{constructor(){this.type="effect",this.name="",this.invisible=!1,this.noRecolor=!1,this.color="#000",this.icon="",this.template=()=>"",this.handlers=()=>{},this.supports=()=>!0}}},,function(t,e,i){"use strict";function a(t,e){const i=sessionStorage;return new Promise((a,n)=>{const r="uppload_cache_"+JSON.stringify(t),s=new Date;s.setDate(s.getDate()+1);const o=i.getItem(r);if(o){const t=JSON.parse(o);if(t.ttl&&new Date(t.ttl).getTime()>(new Date).getTime())return a(t.result)}window.fetch(t,e).then(t=>{if(!t.ok)throw new Error("errors.response_not_ok");return t.json()}).then(t=>{i.setItem(r,JSON.stringify({ttl:s,updatedAt:new Date,result:t})),a(t)}).catch(t=>n(t))})}i.d(e,"a",(function(){return a})),i.d(e,"b",(function(){return n}));const n=t=>new Promise((e,i)=>{window.fetch("https://images.weserv.nl/?url="+encodeURIComponent(t)).then(t=>{if(!t.ok)throw new Error("errors.response_not_ok");return t.blob()}).then(t=>e(t)).catch(t=>i(t))})},,,function(t,e,i){"use strict";i.d(e,"a",(function(){return c}));var a=i(17),n=i(20),r=i(4),s=i(26),o=i(16);class c extends a.a{constructor({apiKey:t,name:e,icon:i,color:a,poweredByUrl:c,popularEndpoint:l,searchEndpoint:h,getButton:d,getPopularResults:u,getSearchResults:p,noRecolor:f,fetchSettings:m}){super(),this.results=[],this.loading=!1,this.noRecolor=!1,this.template=({translate:t})=>`\n      <div class="search-container"><form class="search-search-form">\n      <div class="service-icon">${Object(s.a)(this.icon,this)}</div>\n      <label><span>${t(`services.${this.name}.label`)||t("services.search.label")}</span>\n        <input class="search-search-input" type="search" placeholder="${t("services.search.placeholder")}" required></label>\n        <button type="submit" style="background: ${this.color}">${t("services.search.button",t(`services.${this.name}.title`))}</button>\n      </form>\n      <div class="search-images"></div>\n      <p class="search-footer">${t("services.search.imagesPoweredBy",`<a href="${this.poweredByUrl}" target="_blank">${t(`services.${this.name}.title`)}</a>`)}</p></div>\n      <button class="need-help-link"><span>${t("needHelp")}</span aria-hidden="true"><span>?</span></button>\n      <div class="uppload-loader search-loader">\n        <div></div>\n        <p>${t("fetching",t(`services.${this.name}.title`))}</p>\n      </div>\n    `,this.handlers=t=>{const e=t.uppload.container.querySelector(".search-search-form");e&&Object(r.e)(e,"submit",e=>{const i=t.uppload.container.querySelector(".search-search-input");if(i){const e=i.value;Object(n.a)(this.searchEndpoint(this.apiKey,e),this.fetchSettings).then(e=>{this.results=this.getSearchResults(e),this.update(t)}).catch(()=>t.handle(new Error("errors.unable_to_search")))}return e.preventDefault(),!1}),this.updateImages(t);t.uppload.container.querySelectorAll(".search-images button").forEach(e=>{Object(r.e)(e,"click",()=>{const i=e.getAttribute("data-full-url");this.loading=!0,this.update(t),i&&Object(n.b)(i).then(i=>{return t.next((a=Object(o.a)(i),n=this.name,r=e.getAttribute("aria-label"),a.name=`${r||n+"-import"}-${Math.random().toString(36).slice(2)}.jpg`,a.type="image/jpeg",a));var a,n,r}).catch(e=>t.handle("errors.response_not_ok")).then(()=>this.loading=!1)})});const i=t.uppload.container.querySelector(".need-help-link");i&&Object(r.e)(i,"click",()=>t.showHelp("/services/search/"+this.name))},this.name=e,this.icon=i,this.color=a,this.apiKey=t,this.noRecolor=!!f,this.poweredByUrl=c,this.popularEndpoint=l(this.apiKey),this.searchEndpoint=h,this.getButton=d,this.getPopularResults=u,this.getSearchResults=p,m&&(this.fetchSettings=m(this.apiKey)),this.popularEndpoint&&Object(n.a)(this.popularEndpoint,this.fetchSettings).then(t=>{this.results=this.getPopularResults(t)}).catch(()=>{})}updateImages(t){const e=t.uppload.container.querySelector(".search-images");e&&(e.innerHTML=`\n        ${this.results.map(t=>this.getButton(t)).join("\n")}\n      `)}update(t){this.updateImages(t),t&&this.handlers(t);const e=t.uppload.container.querySelector(".search-loader"),i=t.uppload.container.querySelector(".search-container");i&&(i.style.display=this.loading?"none":""),e&&(e.style.display=this.loading?"flex":"none")}}},,function(t,e,i){"use strict";var a=i(75);i.d(e,"Uppload",(function(){return a.a}));i(17),i(18),i(4);var n=i(38);i.o(n,"en")&&i.d(e,"en",(function(){return n.en})),i.o(n,"xhrUploader")&&i.d(e,"xhrUploader",(function(){return n.xhrUploader}));i(20),i(12);var r=i(74);i.d(e,"en",(function(){return r.a}));var s=i(39);i.d(e,"xhrUploader",(function(){return s.a}));var o=i(40);i.d(e,"Camera",(function(){return o.a}));i(41),i(42);var c=i(43);i.d(e,"Local",(function(){return c.a}));i(44),i(45),i(46),i(47);var l=i(48);i.d(e,"URL",(function(){return l.a}));i(49),i(50),i(51),i(52),i(53),i(54),i(55),i(56),i(57),i(58),i(59),i(60),i(61);var h=i(62);i.d(e,"Crop",(function(){return h.a}));i(63),i(64),i(65),i(66),i(67),i(68),i(69),i(70),i(71),i(72),i(73)},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));const a=(t,e)=>e.noRecolor?t:t.replace(/#000/g,e.color||"#000")},function(t,e,i){
/*!
 * Cropper.js v1.5.9
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2020-09-10T13:16:26.743Z
 */
t.exports=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function a(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}function n(t,e){var i=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),i.push.apply(i,a)}return i}function r(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?n(Object(i),!0).forEach((function(e){a(t,e,i[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(i,e))}))}return t}function s(t){return function(t){if(Array.isArray(t))return o(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return o(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}var c="undefined"!=typeof window&&void 0!==window.document,l=c?window:{},h=!(!c||!l.document.documentElement)&&"ontouchstart"in l.document.documentElement,d=!!c&&"PointerEvent"in l,u="".concat("cropper","-crop"),p="".concat("cropper","-disabled"),f="".concat("cropper","-hidden"),m="".concat("cropper","-hide"),g="".concat("cropper","-invisible"),v="".concat("cropper","-modal"),b="".concat("cropper","-move"),y="".concat("cropper","Action"),w="".concat("cropper","Preview"),x=h?"touchstart":"mousedown",k=h?"touchmove":"mousemove",O=h?"touchend touchcancel":"mouseup",D=d?"pointerdown":x,S=d?"pointermove":k,C=d?"pointerup pointercancel":O,M=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,j=/^data:/,$=/^data:image\/jpeg;base64,/,E=/^img|canvas$/i,T={viewMode:0,dragMode:"crop",initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},B=Number.isNaN||l.isNaN;function A(t){return"number"==typeof t&&!B(t)}var R=function(t){return t>0&&t<1/0};function L(t){return void 0===t}function q(e){return"object"===t(e)&&null!==e}var N=Object.prototype.hasOwnProperty;function H(t){if(!q(t))return!1;try{var e=t.constructor,i=e.prototype;return e&&i&&N.call(i,"isPrototypeOf")}catch(t){return!1}}function U(t){return"function"==typeof t}var z=Array.prototype.slice;function I(t){return Array.from?Array.from(t):z.call(t)}function P(t,e){return t&&U(e)&&(Array.isArray(t)||A(t.length)?I(t).forEach((function(i,a){e.call(t,i,a,t)})):q(t)&&Object.keys(t).forEach((function(i){e.call(t,t[i],i,t)}))),t}var W=Object.assign||function(t){for(var e=arguments.length,i=new Array(e>1?e-1:0),a=1;a<e;a++)i[a-1]=arguments[a];return q(t)&&i.length>0&&i.forEach((function(e){q(e)&&Object.keys(e).forEach((function(i){t[i]=e[i]}))})),t},F=/\.\d*(?:0|9){12}\d*$/;function Y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e11;return F.test(t)?Math.round(t*e)/e:t}var _=/^width|height|left|top|marginLeft|marginTop$/;function X(t,e){var i=t.style;P(e,(function(t,e){_.test(e)&&A(t)&&(t="".concat(t,"px")),i[e]=t}))}function K(t,e){if(e)if(A(t.length))P(t,(function(t){K(t,e)}));else if(t.classList)t.classList.add(e);else{var i=t.className.trim();i?i.indexOf(e)<0&&(t.className="".concat(i," ").concat(e)):t.className=e}}function V(t,e){e&&(A(t.length)?P(t,(function(t){V(t,e)})):t.classList?t.classList.remove(e):t.className.indexOf(e)>=0&&(t.className=t.className.replace(e,"")))}function G(t,e,i){e&&(A(t.length)?P(t,(function(t){G(t,e,i)})):i?K(t,e):V(t,e))}var Q=/([a-z\d])([A-Z])/g;function J(t){return t.replace(Q,"$1-$2").toLowerCase()}function Z(t,e){return q(t[e])?t[e]:t.dataset?t.dataset[e]:t.getAttribute("data-".concat(J(e)))}function tt(t,e,i){q(i)?t[e]=i:t.dataset?t.dataset[e]=i:t.setAttribute("data-".concat(J(e)),i)}var et=/\s\s*/,it=function(){var t=!1;if(c){var e=!1,i=function(){},a=Object.defineProperty({},"once",{get:function(){return t=!0,e},set:function(t){e=t}});l.addEventListener("test",i,a),l.removeEventListener("test",i,a)}return t}();function at(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=i;e.trim().split(et).forEach((function(e){if(!it){var r=t.listeners;r&&r[e]&&r[e][i]&&(n=r[e][i],delete r[e][i],0===Object.keys(r[e]).length&&delete r[e],0===Object.keys(r).length&&delete t.listeners)}t.removeEventListener(e,n,a)}))}function nt(t,e,i){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},n=i;e.trim().split(et).forEach((function(e){if(a.once&&!it){var r=t.listeners,s=void 0===r?{}:r;n=function(){delete s[e][i],t.removeEventListener(e,n,a);for(var r=arguments.length,o=new Array(r),c=0;c<r;c++)o[c]=arguments[c];i.apply(t,o)},s[e]||(s[e]={}),s[e][i]&&t.removeEventListener(e,s[e][i],a),s[e][i]=n,t.listeners=s}t.addEventListener(e,n,a)}))}function rt(t,e,i){var a;return U(Event)&&U(CustomEvent)?a=new CustomEvent(e,{detail:i,bubbles:!0,cancelable:!0}):(a=document.createEvent("CustomEvent")).initCustomEvent(e,!0,!0,i),t.dispatchEvent(a)}function st(t){var e=t.getBoundingClientRect();return{left:e.left+(window.pageXOffset-document.documentElement.clientLeft),top:e.top+(window.pageYOffset-document.documentElement.clientTop)}}var ot=l.location,ct=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i;function lt(t){var e=t.match(ct);return null!==e&&(e[1]!==ot.protocol||e[2]!==ot.hostname||e[3]!==ot.port)}function ht(t){var e="timestamp=".concat((new Date).getTime());return t+(-1===t.indexOf("?")?"?":"&")+e}function dt(t){var e=t.rotate,i=t.scaleX,a=t.scaleY,n=t.translateX,r=t.translateY,s=[];A(n)&&0!==n&&s.push("translateX(".concat(n,"px)")),A(r)&&0!==r&&s.push("translateY(".concat(r,"px)")),A(e)&&0!==e&&s.push("rotate(".concat(e,"deg)")),A(i)&&1!==i&&s.push("scaleX(".concat(i,")")),A(a)&&1!==a&&s.push("scaleY(".concat(a,")"));var o=s.length?s.join(" "):"none";return{WebkitTransform:o,msTransform:o,transform:o}}function ut(t,e){var i=t.pageX,a=t.pageY,n={endX:i,endY:a};return e?n:r({startX:i,startY:a},n)}function pt(t){var e=t.aspectRatio,i=t.height,a=t.width,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"contain",r=R(a),s=R(i);if(r&&s){var o=i*e;"contain"===n&&o>a||"cover"===n&&o<a?i=a/e:a=i*e}else r?i=a/e:s&&(a=i*e);return{width:a,height:i}}function ft(t,e,i,a){var n=e.aspectRatio,r=e.naturalWidth,o=e.naturalHeight,c=e.rotate,l=void 0===c?0:c,h=e.scaleX,d=void 0===h?1:h,u=e.scaleY,p=void 0===u?1:u,f=i.aspectRatio,m=i.naturalWidth,g=i.naturalHeight,v=a.fillColor,b=void 0===v?"transparent":v,y=a.imageSmoothingEnabled,w=void 0===y||y,x=a.imageSmoothingQuality,k=void 0===x?"low":x,O=a.maxWidth,D=void 0===O?1/0:O,S=a.maxHeight,C=void 0===S?1/0:S,M=a.minWidth,j=void 0===M?0:M,$=a.minHeight,E=void 0===$?0:$,T=document.createElement("canvas"),B=T.getContext("2d"),A=pt({aspectRatio:f,width:D,height:C}),R=pt({aspectRatio:f,width:j,height:E},"cover"),L=Math.min(A.width,Math.max(R.width,m)),q=Math.min(A.height,Math.max(R.height,g)),N=pt({aspectRatio:n,width:D,height:C}),H=pt({aspectRatio:n,width:j,height:E},"cover"),U=Math.min(N.width,Math.max(H.width,r)),z=Math.min(N.height,Math.max(H.height,o)),I=[-U/2,-z/2,U,z];return T.width=Y(L),T.height=Y(q),B.fillStyle=b,B.fillRect(0,0,L,q),B.save(),B.translate(L/2,q/2),B.rotate(l*Math.PI/180),B.scale(d,p),B.imageSmoothingEnabled=w,B.imageSmoothingQuality=k,B.drawImage.apply(B,[t].concat(s(I.map((function(t){return Math.floor(Y(t))}))))),B.restore(),T}var mt=String.fromCharCode,gt=/^data:.*,/;function vt(t){var e,i=new DataView(t);try{var a,n,r;if(255===i.getUint8(0)&&216===i.getUint8(1))for(var s=i.byteLength,o=2;o+1<s;){if(255===i.getUint8(o)&&225===i.getUint8(o+1)){n=o;break}o+=1}if(n){var c=n+10;if("Exif"===function(t,e,i){var a="";i+=e;for(var n=e;n<i;n+=1)a+=mt(t.getUint8(n));return a}(i,n+4,4)){var l=i.getUint16(c);if(((a=18761===l)||19789===l)&&42===i.getUint16(c+2,a)){var h=i.getUint32(c+4,a);h>=8&&(r=c+h)}}}if(r){var d,u,p=i.getUint16(r,a);for(u=0;u<p;u+=1)if(d=r+12*u+2,274===i.getUint16(d,a)){d+=8,e=i.getUint16(d,a),i.setUint16(d,1,a);break}}}catch(t){e=1}return e}var bt={render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t=this.element,e=this.options,i=this.container,a=this.cropper,n=Number(e.minContainerWidth),r=Number(e.minContainerHeight);K(a,f),V(t,f);var s={width:Math.max(i.offsetWidth,n>=0?n:200),height:Math.max(i.offsetHeight,r>=0?r:100)};this.containerData=s,X(a,{width:s.width,height:s.height}),K(t,f),V(a,f)},initCanvas:function(){var t=this.containerData,e=this.imageData,i=this.options.viewMode,a=Math.abs(e.rotate)%180==90,n=a?e.naturalHeight:e.naturalWidth,r=a?e.naturalWidth:e.naturalHeight,s=n/r,o=t.width,c=t.height;t.height*s>t.width?3===i?o=t.height*s:c=t.width/s:3===i?c=t.width/s:o=t.height*s;var l={aspectRatio:s,naturalWidth:n,naturalHeight:r,width:o,height:c};this.canvasData=l,this.limited=1===i||2===i,this.limitCanvas(!0,!0),l.width=Math.min(Math.max(l.width,l.minWidth),l.maxWidth),l.height=Math.min(Math.max(l.height,l.minHeight),l.maxHeight),l.left=(t.width-l.width)/2,l.top=(t.height-l.height)/2,l.oldLeft=l.left,l.oldTop=l.top,this.initialCanvasData=W({},l)},limitCanvas:function(t,e){var i=this.options,a=this.containerData,n=this.canvasData,r=this.cropBoxData,s=i.viewMode,o=n.aspectRatio,c=this.cropped&&r;if(t){var l=Number(i.minCanvasWidth)||0,h=Number(i.minCanvasHeight)||0;s>1?(l=Math.max(l,a.width),h=Math.max(h,a.height),3===s&&(h*o>l?l=h*o:h=l/o)):s>0&&(l?l=Math.max(l,c?r.width:0):h?h=Math.max(h,c?r.height:0):c&&(l=r.width,(h=r.height)*o>l?l=h*o:h=l/o));var d=pt({aspectRatio:o,width:l,height:h});l=d.width,h=d.height,n.minWidth=l,n.minHeight=h,n.maxWidth=1/0,n.maxHeight=1/0}if(e)if(s>(c?0:1)){var u=a.width-n.width,p=a.height-n.height;n.minLeft=Math.min(0,u),n.minTop=Math.min(0,p),n.maxLeft=Math.max(0,u),n.maxTop=Math.max(0,p),c&&this.limited&&(n.minLeft=Math.min(r.left,r.left+(r.width-n.width)),n.minTop=Math.min(r.top,r.top+(r.height-n.height)),n.maxLeft=r.left,n.maxTop=r.top,2===s&&(n.width>=a.width&&(n.minLeft=Math.min(0,u),n.maxLeft=Math.max(0,u)),n.height>=a.height&&(n.minTop=Math.min(0,p),n.maxTop=Math.max(0,p))))}else n.minLeft=-n.width,n.minTop=-n.height,n.maxLeft=a.width,n.maxTop=a.height},renderCanvas:function(t,e){var i=this.canvasData,a=this.imageData;if(e){var n=function(t){var e=t.width,i=t.height,a=t.degree;if(90==(a=Math.abs(a)%180))return{width:i,height:e};var n=a%90*Math.PI/180,r=Math.sin(n),s=Math.cos(n),o=e*s+i*r,c=e*r+i*s;return a>90?{width:c,height:o}:{width:o,height:c}}({width:a.naturalWidth*Math.abs(a.scaleX||1),height:a.naturalHeight*Math.abs(a.scaleY||1),degree:a.rotate||0}),r=n.width,s=n.height,o=i.width*(r/i.naturalWidth),c=i.height*(s/i.naturalHeight);i.left-=(o-i.width)/2,i.top-=(c-i.height)/2,i.width=o,i.height=c,i.aspectRatio=r/s,i.naturalWidth=r,i.naturalHeight=s,this.limitCanvas(!0,!1)}(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCanvas(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,X(this.canvas,W({width:i.width,height:i.height},dt({translateX:i.left,translateY:i.top}))),this.renderImage(t),this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(t){var e=this.canvasData,i=this.imageData,a=i.naturalWidth*(e.width/e.naturalWidth),n=i.naturalHeight*(e.height/e.naturalHeight);W(i,{width:a,height:n,left:(e.width-a)/2,top:(e.height-n)/2}),X(this.image,W({width:i.width,height:i.height},dt(W({translateX:i.left,translateY:i.top},i)))),t&&this.output()},initCropBox:function(){var t=this.options,e=this.canvasData,i=t.aspectRatio||t.initialAspectRatio,a=Number(t.autoCropArea)||.8,n={width:e.width,height:e.height};i&&(e.height*i>e.width?n.height=n.width/i:n.width=n.height*i),this.cropBoxData=n,this.limitCropBox(!0,!0),n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth),n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight),n.width=Math.max(n.minWidth,n.width*a),n.height=Math.max(n.minHeight,n.height*a),n.left=e.left+(e.width-n.width)/2,n.top=e.top+(e.height-n.height)/2,n.oldLeft=n.left,n.oldTop=n.top,this.initialCropBoxData=W({},n)},limitCropBox:function(t,e){var i=this.options,a=this.containerData,n=this.canvasData,r=this.cropBoxData,s=this.limited,o=i.aspectRatio;if(t){var c=Number(i.minCropBoxWidth)||0,l=Number(i.minCropBoxHeight)||0,h=s?Math.min(a.width,n.width,n.width+n.left,a.width-n.left):a.width,d=s?Math.min(a.height,n.height,n.height+n.top,a.height-n.top):a.height;c=Math.min(c,a.width),l=Math.min(l,a.height),o&&(c&&l?l*o>c?l=c/o:c=l*o:c?l=c/o:l&&(c=l*o),d*o>h?d=h/o:h=d*o),r.minWidth=Math.min(c,h),r.minHeight=Math.min(l,d),r.maxWidth=h,r.maxHeight=d}e&&(s?(r.minLeft=Math.max(0,n.left),r.minTop=Math.max(0,n.top),r.maxLeft=Math.min(a.width,n.left+n.width)-r.width,r.maxTop=Math.min(a.height,n.top+n.height)-r.height):(r.minLeft=0,r.minTop=0,r.maxLeft=a.width-r.width,r.maxTop=a.height-r.height))},renderCropBox:function(){var t=this.options,e=this.containerData,i=this.cropBoxData;(i.width>i.maxWidth||i.width<i.minWidth)&&(i.left=i.oldLeft),(i.height>i.maxHeight||i.height<i.minHeight)&&(i.top=i.oldTop),i.width=Math.min(Math.max(i.width,i.minWidth),i.maxWidth),i.height=Math.min(Math.max(i.height,i.minHeight),i.maxHeight),this.limitCropBox(!1,!0),i.left=Math.min(Math.max(i.left,i.minLeft),i.maxLeft),i.top=Math.min(Math.max(i.top,i.minTop),i.maxTop),i.oldLeft=i.left,i.oldTop=i.top,t.movable&&t.cropBoxMovable&&tt(this.face,y,i.width>=e.width&&i.height>=e.height?"move":"all"),X(this.cropBox,W({width:i.width,height:i.height},dt({translateX:i.left,translateY:i.top}))),this.cropped&&this.limited&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){this.preview(),rt(this.element,"crop",this.getData())}},yt={initPreview:function(){var t=this.element,e=this.crossOrigin,i=this.options.preview,a=e?this.crossOriginUrl:this.url,n=t.alt||"The image to preview",r=document.createElement("img");if(e&&(r.crossOrigin=e),r.src=a,r.alt=n,this.viewBox.appendChild(r),this.viewBoxImage=r,i){var s=i;"string"==typeof i?s=t.ownerDocument.querySelectorAll(i):i.querySelector&&(s=[i]),this.previews=s,P(s,(function(t){var i=document.createElement("img");tt(t,w,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),e&&(i.crossOrigin=e),i.src=a,i.alt=n,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"',t.innerHTML="",t.appendChild(i)}))}},resetPreview:function(){P(this.previews,(function(t){var e=Z(t,w);X(t,{width:e.width,height:e.height}),t.innerHTML=e.html,function(t,e){if(q(t[e]))try{delete t[e]}catch(i){t[e]=void 0}else if(t.dataset)try{delete t.dataset[e]}catch(i){t.dataset[e]=void 0}else t.removeAttribute("data-".concat(J(e)))}(t,w)}))},preview:function(){var t=this.imageData,e=this.canvasData,i=this.cropBoxData,a=i.width,n=i.height,r=t.width,s=t.height,o=i.left-e.left-t.left,c=i.top-e.top-t.top;this.cropped&&!this.disabled&&(X(this.viewBoxImage,W({width:r,height:s},dt(W({translateX:-o,translateY:-c},t)))),P(this.previews,(function(e){var i=Z(e,w),l=i.width,h=i.height,d=l,u=h,p=1;a&&(u=n*(p=l/a)),n&&u>h&&(d=a*(p=h/n),u=h),X(e,{width:d,height:u}),X(e.getElementsByTagName("img")[0],W({width:r*p,height:s*p},dt(W({translateX:-o*p,translateY:-c*p},t))))})))}},wt={bind:function(){var t=this.element,e=this.options,i=this.cropper;U(e.cropstart)&&nt(t,"cropstart",e.cropstart),U(e.cropmove)&&nt(t,"cropmove",e.cropmove),U(e.cropend)&&nt(t,"cropend",e.cropend),U(e.crop)&&nt(t,"crop",e.crop),U(e.zoom)&&nt(t,"zoom",e.zoom),nt(i,D,this.onCropStart=this.cropStart.bind(this)),e.zoomable&&e.zoomOnWheel&&nt(i,"wheel",this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&nt(i,"dblclick",this.onDblclick=this.dblclick.bind(this)),nt(t.ownerDocument,S,this.onCropMove=this.cropMove.bind(this)),nt(t.ownerDocument,C,this.onCropEnd=this.cropEnd.bind(this)),e.responsive&&nt(window,"resize",this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,e=this.options,i=this.cropper;U(e.cropstart)&&at(t,"cropstart",e.cropstart),U(e.cropmove)&&at(t,"cropmove",e.cropmove),U(e.cropend)&&at(t,"cropend",e.cropend),U(e.crop)&&at(t,"crop",e.crop),U(e.zoom)&&at(t,"zoom",e.zoom),at(i,D,this.onCropStart),e.zoomable&&e.zoomOnWheel&&at(i,"wheel",this.onWheel,{passive:!1,capture:!0}),e.toggleDragModeOnDblclick&&at(i,"dblclick",this.onDblclick),at(t.ownerDocument,S,this.onCropMove),at(t.ownerDocument,C,this.onCropEnd),e.responsive&&at(window,"resize",this.onResize)}},xt={resize:function(){if(!this.disabled){var t,e,i=this.options,a=this.container,n=this.containerData,r=a.offsetWidth/n.width;1===r&&a.offsetHeight===n.height||(i.restore&&(t=this.getCanvasData(),e=this.getCropBoxData()),this.render(),i.restore&&(this.setCanvasData(P(t,(function(e,i){t[i]=e*r}))),this.setCropBoxData(P(e,(function(t,i){e[i]=t*r})))))}},dblclick:function(){var t,e;this.disabled||"none"===this.options.dragMode||this.setDragMode((t=this.dragBox,e=u,(t.classList?t.classList.contains(e):t.className.indexOf(e)>-1)?"move":"crop"))},wheel:function(t){var e=this,i=Number(this.options.wheelZoomRatio)||.1,a=1;this.disabled||(t.preventDefault(),this.wheeling||(this.wheeling=!0,setTimeout((function(){e.wheeling=!1}),50),t.deltaY?a=t.deltaY>0?1:-1:t.wheelDelta?a=-t.wheelDelta/120:t.detail&&(a=t.detail>0?1:-1),this.zoom(-a*i,t)))},cropStart:function(t){var e=t.buttons,i=t.button;if(!(this.disabled||("mousedown"===t.type||"pointerdown"===t.type&&"mouse"===t.pointerType)&&(A(e)&&1!==e||A(i)&&0!==i||t.ctrlKey))){var a,n=this.options,r=this.pointers;t.changedTouches?P(t.changedTouches,(function(t){r[t.identifier]=ut(t)})):r[t.pointerId||0]=ut(t),a=Object.keys(r).length>1&&n.zoomable&&n.zoomOnTouch?"zoom":Z(t.target,y),M.test(a)&&!1!==rt(this.element,"cropstart",{originalEvent:t,action:a})&&(t.preventDefault(),this.action=a,this.cropping=!1,"crop"===a&&(this.cropping=!0,K(this.dragBox,v)))}},cropMove:function(t){var e=this.action;if(!this.disabled&&e){var i=this.pointers;t.preventDefault(),!1!==rt(this.element,"cropmove",{originalEvent:t,action:e})&&(t.changedTouches?P(t.changedTouches,(function(t){W(i[t.identifier]||{},ut(t,!0))})):W(i[t.pointerId||0]||{},ut(t,!0)),this.change(t))}},cropEnd:function(t){if(!this.disabled){var e=this.action,i=this.pointers;t.changedTouches?P(t.changedTouches,(function(t){delete i[t.identifier]})):delete i[t.pointerId||0],e&&(t.preventDefault(),Object.keys(i).length||(this.action=""),this.cropping&&(this.cropping=!1,G(this.dragBox,v,this.cropped&&this.options.modal)),rt(this.element,"cropend",{originalEvent:t,action:e}))}}},kt={change:function(t){var e,i=this.options,a=this.canvasData,n=this.containerData,s=this.cropBoxData,o=this.pointers,c=this.action,l=i.aspectRatio,h=s.left,d=s.top,u=s.width,p=s.height,m=h+u,g=d+p,v=0,b=0,y=n.width,w=n.height,x=!0;!l&&t.shiftKey&&(l=u&&p?u/p:1),this.limited&&(v=s.minLeft,b=s.minTop,y=v+Math.min(n.width,a.width,a.left+a.width),w=b+Math.min(n.height,a.height,a.top+a.height));var k=o[Object.keys(o)[0]],O={x:k.endX-k.startX,y:k.endY-k.startY},D=function(t){switch(t){case"e":m+O.x>y&&(O.x=y-m);break;case"w":h+O.x<v&&(O.x=v-h);break;case"n":d+O.y<b&&(O.y=b-d);break;case"s":g+O.y>w&&(O.y=w-g)}};switch(c){case"all":h+=O.x,d+=O.y;break;case"e":if(O.x>=0&&(m>=y||l&&(d<=b||g>=w))){x=!1;break}D("e"),(u+=O.x)<0&&(c="w",h-=u=-u),l&&(p=u/l,d+=(s.height-p)/2);break;case"n":if(O.y<=0&&(d<=b||l&&(h<=v||m>=y))){x=!1;break}D("n"),p-=O.y,d+=O.y,p<0&&(c="s",d-=p=-p),l&&(u=p*l,h+=(s.width-u)/2);break;case"w":if(O.x<=0&&(h<=v||l&&(d<=b||g>=w))){x=!1;break}D("w"),u-=O.x,h+=O.x,u<0&&(c="e",h-=u=-u),l&&(p=u/l,d+=(s.height-p)/2);break;case"s":if(O.y>=0&&(g>=w||l&&(h<=v||m>=y))){x=!1;break}D("s"),(p+=O.y)<0&&(c="n",d-=p=-p),l&&(u=p*l,h+=(s.width-u)/2);break;case"ne":if(l){if(O.y<=0&&(d<=b||m>=y)){x=!1;break}D("n"),p-=O.y,d+=O.y,u=p*l}else D("n"),D("e"),O.x>=0?m<y?u+=O.x:O.y<=0&&d<=b&&(x=!1):u+=O.x,O.y<=0?d>b&&(p-=O.y,d+=O.y):(p-=O.y,d+=O.y);u<0&&p<0?(c="sw",d-=p=-p,h-=u=-u):u<0?(c="nw",h-=u=-u):p<0&&(c="se",d-=p=-p);break;case"nw":if(l){if(O.y<=0&&(d<=b||h<=v)){x=!1;break}D("n"),p-=O.y,d+=O.y,u=p*l,h+=s.width-u}else D("n"),D("w"),O.x<=0?h>v?(u-=O.x,h+=O.x):O.y<=0&&d<=b&&(x=!1):(u-=O.x,h+=O.x),O.y<=0?d>b&&(p-=O.y,d+=O.y):(p-=O.y,d+=O.y);u<0&&p<0?(c="se",d-=p=-p,h-=u=-u):u<0?(c="ne",h-=u=-u):p<0&&(c="sw",d-=p=-p);break;case"sw":if(l){if(O.x<=0&&(h<=v||g>=w)){x=!1;break}D("w"),u-=O.x,h+=O.x,p=u/l}else D("s"),D("w"),O.x<=0?h>v?(u-=O.x,h+=O.x):O.y>=0&&g>=w&&(x=!1):(u-=O.x,h+=O.x),O.y>=0?g<w&&(p+=O.y):p+=O.y;u<0&&p<0?(c="ne",d-=p=-p,h-=u=-u):u<0?(c="se",h-=u=-u):p<0&&(c="nw",d-=p=-p);break;case"se":if(l){if(O.x>=0&&(m>=y||g>=w)){x=!1;break}D("e"),p=(u+=O.x)/l}else D("s"),D("e"),O.x>=0?m<y?u+=O.x:O.y>=0&&g>=w&&(x=!1):u+=O.x,O.y>=0?g<w&&(p+=O.y):p+=O.y;u<0&&p<0?(c="nw",d-=p=-p,h-=u=-u):u<0?(c="sw",h-=u=-u):p<0&&(c="ne",d-=p=-p);break;case"move":this.move(O.x,O.y),x=!1;break;case"zoom":this.zoom(function(t){var e=r({},t),i=0;return P(t,(function(t,a){delete e[a],P(e,(function(e){var a=Math.abs(t.startX-e.startX),n=Math.abs(t.startY-e.startY),r=Math.abs(t.endX-e.endX),s=Math.abs(t.endY-e.endY),o=Math.sqrt(a*a+n*n),c=(Math.sqrt(r*r+s*s)-o)/o;Math.abs(c)>Math.abs(i)&&(i=c)}))})),i}(o),t),x=!1;break;case"crop":if(!O.x||!O.y){x=!1;break}e=st(this.cropper),h=k.startX-e.left,d=k.startY-e.top,u=s.minWidth,p=s.minHeight,O.x>0?c=O.y>0?"se":"ne":O.x<0&&(h-=u,c=O.y>0?"sw":"nw"),O.y<0&&(d-=p),this.cropped||(V(this.cropBox,f),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}x&&(s.width=u,s.height=p,s.left=h,s.top=d,this.action=c,this.renderCropBox()),P(o,(function(t){t.startX=t.endX,t.startY=t.endY}))}},Ot={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&K(this.dragBox,v),V(this.cropBox,f),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=W({},this.initialImageData),this.canvasData=W({},this.initialCanvasData),this.cropBoxData=W({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(W(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),V(this.dragBox,v),K(this.cropBox,f)),this},replace:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.disabled&&t&&(this.isImg&&(this.element.src=t),e?(this.url=t,this.image.src=t,this.ready&&(this.viewBoxImage.src=t,P(this.previews,(function(e){e.getElementsByTagName("img")[0].src=t})))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(t))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,V(this.cropper,p)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,K(this.cropper,p)),this},destroy:function(){var t=this.element;return t.cropper?(t.cropper=void 0,this.isImg&&this.replaced&&(t.src=this.originalUrl),this.uncreate(),this):this},move:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.canvasData,a=i.left,n=i.top;return this.moveTo(L(t)?t:a+Number(t),L(e)?e:n+Number(e))},moveTo:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.canvasData,a=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.movable&&(A(t)&&(i.left=t,a=!0),A(e)&&(i.top=e,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(t,e){var i=this.canvasData;return t=(t=Number(t))<0?1/(1-t):1+t,this.zoomTo(i.width*t/i.naturalWidth,null,e)},zoomTo:function(t,e,i){var a=this.options,n=this.canvasData,r=n.width,s=n.height,o=n.naturalWidth,c=n.naturalHeight;if((t=Number(t))>=0&&this.ready&&!this.disabled&&a.zoomable){var l=o*t,h=c*t;if(!1===rt(this.element,"zoom",{ratio:t,oldRatio:r/o,originalEvent:i}))return this;if(i){var d=this.pointers,u=st(this.cropper),p=d&&Object.keys(d).length?function(t){var e=0,i=0,a=0;return P(t,(function(t){var n=t.startX,r=t.startY;e+=n,i+=r,a+=1})),{pageX:e/=a,pageY:i/=a}}(d):{pageX:i.pageX,pageY:i.pageY};n.left-=(l-r)*((p.pageX-u.left-n.left)/r),n.top-=(h-s)*((p.pageY-u.top-n.top)/s)}else H(e)&&A(e.x)&&A(e.y)?(n.left-=(l-r)*((e.x-n.left)/r),n.top-=(h-s)*((e.y-n.top)/s)):(n.left-=(l-r)/2,n.top-=(h-s)/2);n.width=l,n.height=h,this.renderCanvas(!0)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Number(t))},rotateTo:function(t){return A(t=Number(t))&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var e=this.imageData.scaleY;return this.scale(t,A(e)?e:1)},scaleY:function(t){var e=this.imageData.scaleX;return this.scale(A(e)?e:1,t)},scale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,i=this.imageData,a=!1;return t=Number(t),e=Number(e),this.ready&&!this.disabled&&this.options.scalable&&(A(t)&&(i.scaleX=t,a=!0),A(e)&&(i.scaleY=e,a=!0),a&&this.renderCanvas(!0,!0)),this},getData:function(){var t,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],i=this.options,a=this.imageData,n=this.canvasData,r=this.cropBoxData;if(this.ready&&this.cropped){t={x:r.left-n.left,y:r.top-n.top,width:r.width,height:r.height};var s=a.width/a.naturalWidth;if(P(t,(function(e,i){t[i]=e/s})),e){var o=Math.round(t.y+t.height),c=Math.round(t.x+t.width);t.x=Math.round(t.x),t.y=Math.round(t.y),t.width=c-t.x,t.height=o-t.y}}else t={x:0,y:0,width:0,height:0};return i.rotatable&&(t.rotate=a.rotate||0),i.scalable&&(t.scaleX=a.scaleX||1,t.scaleY=a.scaleY||1),t},setData:function(t){var e=this.options,i=this.imageData,a=this.canvasData,n={};if(this.ready&&!this.disabled&&H(t)){var r=!1;e.rotatable&&A(t.rotate)&&t.rotate!==i.rotate&&(i.rotate=t.rotate,r=!0),e.scalable&&(A(t.scaleX)&&t.scaleX!==i.scaleX&&(i.scaleX=t.scaleX,r=!0),A(t.scaleY)&&t.scaleY!==i.scaleY&&(i.scaleY=t.scaleY,r=!0)),r&&this.renderCanvas(!0,!0);var s=i.width/i.naturalWidth;A(t.x)&&(n.left=t.x*s+a.left),A(t.y)&&(n.top=t.y*s+a.top),A(t.width)&&(n.width=t.width*s),A(t.height)&&(n.height=t.height*s),this.setCropBoxData(n)}return this},getContainerData:function(){return this.ready?W({},this.containerData):{}},getImageData:function(){return this.sized?W({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,e={};return this.ready&&P(["left","top","width","height","naturalWidth","naturalHeight"],(function(i){e[i]=t[i]})),e},setCanvasData:function(t){var e=this.canvasData,i=e.aspectRatio;return this.ready&&!this.disabled&&H(t)&&(A(t.left)&&(e.left=t.left),A(t.top)&&(e.top=t.top),A(t.width)?(e.width=t.width,e.height=t.width/i):A(t.height)&&(e.height=t.height,e.width=t.height*i),this.renderCanvas(!0)),this},getCropBoxData:function(){var t,e=this.cropBoxData;return this.ready&&this.cropped&&(t={left:e.left,top:e.top,width:e.width,height:e.height}),t||{}},setCropBoxData:function(t){var e,i,a=this.cropBoxData,n=this.options.aspectRatio;return this.ready&&this.cropped&&!this.disabled&&H(t)&&(A(t.left)&&(a.left=t.left),A(t.top)&&(a.top=t.top),A(t.width)&&t.width!==a.width&&(e=!0,a.width=t.width),A(t.height)&&t.height!==a.height&&(i=!0,a.height=t.height),n&&(e?a.height=a.width/n:i&&(a.width=a.height*n)),this.renderCropBox()),this},getCroppedCanvas:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.ready||!window.HTMLCanvasElement)return null;var e=this.canvasData,i=ft(this.image,this.imageData,e,t);if(!this.cropped)return i;var a=this.getData(),n=a.x,r=a.y,o=a.width,c=a.height,l=i.width/Math.floor(e.naturalWidth);1!==l&&(n*=l,r*=l,o*=l,c*=l);var h=o/c,d=pt({aspectRatio:h,width:t.maxWidth||1/0,height:t.maxHeight||1/0}),u=pt({aspectRatio:h,width:t.minWidth||0,height:t.minHeight||0},"cover"),p=pt({aspectRatio:h,width:t.width||(1!==l?i.width:o),height:t.height||(1!==l?i.height:c)}),f=p.width,m=p.height;f=Math.min(d.width,Math.max(u.width,f)),m=Math.min(d.height,Math.max(u.height,m));var g=document.createElement("canvas"),v=g.getContext("2d");g.width=Y(f),g.height=Y(m),v.fillStyle=t.fillColor||"transparent",v.fillRect(0,0,f,m);var b=t.imageSmoothingEnabled,y=void 0===b||b,w=t.imageSmoothingQuality;v.imageSmoothingEnabled=y,w&&(v.imageSmoothingQuality=w);var x,k,O,D,S,C,M=i.width,j=i.height,$=n,E=r;$<=-o||$>M?($=0,x=0,O=0,S=0):$<=0?(O=-$,$=0,S=x=Math.min(M,o+$)):$<=M&&(O=0,S=x=Math.min(o,M-$)),x<=0||E<=-c||E>j?(E=0,k=0,D=0,C=0):E<=0?(D=-E,E=0,C=k=Math.min(j,c+E)):E<=j&&(D=0,C=k=Math.min(c,j-E));var T=[$,E,x,k];if(S>0&&C>0){var B=f/o;T.push(O*B,D*B,S*B,C*B)}return v.drawImage.apply(v,[i].concat(s(T.map((function(t){return Math.floor(Y(t))}))))),g},setAspectRatio:function(t){var e=this.options;return this.disabled||L(t)||(e.aspectRatio=Math.max(0,t)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var e=this.options,i=this.dragBox,a=this.face;if(this.ready&&!this.disabled){var n="crop"===t,r=e.movable&&"move"===t;t=n||r?t:"none",e.dragMode=t,tt(i,y,t),G(i,u,n),G(i,b,r),e.cropBoxMovable||(tt(a,y,t),G(a,u,n),G(a,b,r))}return this}},Dt=l.Cropper,St=function(){function t(i){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e(this,t),!i||!E.test(i.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=i,this.options=W({},T,H(a)&&a),this.cropped=!1,this.disabled=!1,this.pointers={},this.ready=!1,this.reloading=!1,this.replaced=!1,this.sized=!1,this.sizing=!1,this.init()}var a,n,r;return a=t,r=[{key:"noConflict",value:function(){return window.Cropper=Dt,t}},{key:"setDefaults",value:function(t){W(T,H(t)&&t)}}],(n=[{key:"init",value:function(){var t,e=this.element,i=e.tagName.toLowerCase();if(!e.cropper){if(e.cropper=this,"img"===i){if(this.isImg=!0,t=e.getAttribute("src")||"",this.originalUrl=t,!t)return;t=e.src}else"canvas"===i&&window.HTMLCanvasElement&&(t=e.toDataURL());this.load(t)}}},{key:"load",value:function(t){var e=this;if(t){this.url=t,this.imageData={};var i=this.element,a=this.options;if(a.rotatable||a.scalable||(a.checkOrientation=!1),a.checkOrientation&&window.ArrayBuffer)if(j.test(t))$.test(t)?this.read((n=t.replace(gt,""),r=atob(n),s=new ArrayBuffer(r.length),P(o=new Uint8Array(s),(function(t,e){o[e]=r.charCodeAt(e)})),s)):this.clone();else{var n,r,s,o,c=new XMLHttpRequest,l=this.clone.bind(this);this.reloading=!0,this.xhr=c,c.onabort=l,c.onerror=l,c.ontimeout=l,c.onprogress=function(){"image/jpeg"!==c.getResponseHeader("content-type")&&c.abort()},c.onload=function(){e.read(c.response)},c.onloadend=function(){e.reloading=!1,e.xhr=null},a.checkCrossOrigin&&lt(t)&&i.crossOrigin&&(t=ht(t)),c.open("GET",t),c.responseType="arraybuffer",c.withCredentials="use-credentials"===i.crossOrigin,c.send()}else this.clone()}}},{key:"read",value:function(t){var e=this.options,i=this.imageData,a=vt(t),n=0,r=1,s=1;if(a>1){this.url=function(t,e){for(var i=[],a=new Uint8Array(t);a.length>0;)i.push(mt.apply(null,I(a.subarray(0,8192)))),a=a.subarray(8192);return"data:".concat(e,";base64,").concat(btoa(i.join("")))}(t,"image/jpeg");var o=function(t){var e=0,i=1,a=1;switch(t){case 2:i=-1;break;case 3:e=-180;break;case 4:a=-1;break;case 5:e=90,a=-1;break;case 6:e=90;break;case 7:e=90,i=-1;break;case 8:e=-90}return{rotate:e,scaleX:i,scaleY:a}}(a);n=o.rotate,r=o.scaleX,s=o.scaleY}e.rotatable&&(i.rotate=n),e.scalable&&(i.scaleX=r,i.scaleY=s),this.clone()}},{key:"clone",value:function(){var t=this.element,e=this.url,i=t.crossOrigin,a=e;this.options.checkCrossOrigin&&lt(e)&&(i||(i="anonymous"),a=ht(e)),this.crossOrigin=i,this.crossOriginUrl=a;var n=document.createElement("img");i&&(n.crossOrigin=i),n.src=a||e,n.alt=t.alt||"The image to crop",this.image=n,n.onload=this.start.bind(this),n.onerror=this.stop.bind(this),K(n,m),t.parentNode.insertBefore(n,t.nextSibling)}},{key:"start",value:function(){var t=this,e=this.image;e.onload=null,e.onerror=null,this.sizing=!0;var i=l.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(l.navigator.userAgent),a=function(e,i){W(t.imageData,{naturalWidth:e,naturalHeight:i,aspectRatio:e/i}),t.initialImageData=W({},t.imageData),t.sizing=!1,t.sized=!0,t.build()};if(!e.naturalWidth||i){var n=document.createElement("img"),r=document.body||document.documentElement;this.sizingImage=n,n.onload=function(){a(n.width,n.height),i||r.removeChild(n)},n.src=e.src,i||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",r.appendChild(n))}else a(e.naturalWidth,e.naturalHeight)}},{key:"stop",value:function(){var t=this.image;t.onload=null,t.onerror=null,t.parentNode.removeChild(t),this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var t=this.element,e=this.options,i=this.image,a=t.parentNode,n=document.createElement("div");n.innerHTML='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"></div></div><div class="cropper-drag-box"></div><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-cropper-action="e"></span><span class="cropper-line line-n" data-cropper-action="n"></span><span class="cropper-line line-w" data-cropper-action="w"></span><span class="cropper-line line-s" data-cropper-action="s"></span><span class="cropper-point point-e" data-cropper-action="e"></span><span class="cropper-point point-n" data-cropper-action="n"></span><span class="cropper-point point-w" data-cropper-action="w"></span><span class="cropper-point point-s" data-cropper-action="s"></span><span class="cropper-point point-ne" data-cropper-action="ne"></span><span class="cropper-point point-nw" data-cropper-action="nw"></span><span class="cropper-point point-sw" data-cropper-action="sw"></span><span class="cropper-point point-se" data-cropper-action="se"></span></div></div>';var r=n.querySelector(".".concat("cropper","-container")),s=r.querySelector(".".concat("cropper","-canvas")),o=r.querySelector(".".concat("cropper","-drag-box")),c=r.querySelector(".".concat("cropper","-crop-box")),l=c.querySelector(".".concat("cropper","-face"));this.container=a,this.cropper=r,this.canvas=s,this.dragBox=o,this.cropBox=c,this.viewBox=r.querySelector(".".concat("cropper","-view-box")),this.face=l,s.appendChild(i),K(t,f),a.insertBefore(r,t.nextSibling),this.isImg||V(i,m),this.initPreview(),this.bind(),e.initialAspectRatio=Math.max(0,e.initialAspectRatio)||NaN,e.aspectRatio=Math.max(0,e.aspectRatio)||NaN,e.viewMode=Math.max(0,Math.min(3,Math.round(e.viewMode)))||0,K(c,f),e.guides||K(c.getElementsByClassName("".concat("cropper","-dashed")),f),e.center||K(c.getElementsByClassName("".concat("cropper","-center")),f),e.background&&K(r,"".concat("cropper","-bg")),e.highlight||K(l,g),e.cropBoxMovable&&(K(l,b),tt(l,y,"all")),e.cropBoxResizable||(K(c.getElementsByClassName("".concat("cropper","-line")),f),K(c.getElementsByClassName("".concat("cropper","-point")),f)),this.render(),this.ready=!0,this.setDragMode(e.dragMode),e.autoCrop&&this.crop(),this.setData(e.data),U(e.ready)&&nt(t,"ready",e.ready,{once:!0}),rt(t,"ready")}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),V(this.element,f))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}])&&i(a.prototype,n),r&&i(a,r),t}();return W(St.prototype,bt,yt,wt,xt,kt,Ot),St}()},,,,,,,,,,,function(t,e){},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));const a=({endpoint:t,fileKeyName:e="file",method:i="POST",responseKey:a="url",responseFunction:n,settingsFunction:r})=>(s,o)=>new Promise((c,l)=>{const h=new FormData;h.append(e,s);const d=new XMLHttpRequest;d.open(i,t,!0),"function"==typeof r&&r(d),d.addEventListener("progress",t=>{"function"==typeof o&&o(t.loaded/t.total)}),d.addEventListener("load",()=>{const t=d.responseText;if("function"==typeof n)return c(n(t));const e=JSON.parse(t);return c(e[a])}),d.addEventListener("error",()=>l("errors.response_not_ok")),d.addEventListener("abort",()=>l("errors.upload_aborted")),d.send(h)})},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var a=i(17),n=i(4),r=i(16);class s extends a.a{constructor(){super(...arguments),this.name="camera",this.icon='<svg aria-hidden="true" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg"><path d="M63 65l17-33c2-3 5-5 9-5h78c4 0 8 2 9 5l17 33h33c17 0 30 13 30 29v106c0 16-13 29-30 29H30c-17 0-30-13-30-29V94c0-16 13-29 30-29h33zm65 126c27 0 49-22 49-49 0-26-22-48-49-48s-49 22-49 48c0 27 22 49 49 49zm0-20c-16 0-30-13-30-29s14-28 30-28 30 12 30 28-14 29-30 29zm79-48c5 0 10-4 10-9 0-6-5-10-10-10-6 0-10 4-10 10 0 5 4 9 10 9z" fill="#000" fill-rule="nonzero"/></svg>',this.color="#16a085",this.canvas=document.createElement("canvas"),this.gotError=!1,this.waiting=!1,this.frontCamera=!1,this.supports=()=>!(!window.navigator.mediaDevices||!window.navigator.mediaDevices.enumerateDevices||/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),this.template=({translate:t})=>`\n      <div class="service-main">\n        <div class="camera-waiting">${t("services.camera.waiting")}</div>\n        <div class="camera-error">\n          <p>${t("services.camera.unableToRead")}</p>\n          <p><a href="https://uppload.js.org/help/camera" target="_blank">${t("needHelp")}</a></p>\n        </div>\n        <div class="camera-success">\n          <video class="camera-stream"></video>\n        </div>\n      </div>\n      <footer class="service-footer">\n        \x3c!--<button\n          class="camera-switch uppload-button"\n        >${t("services.camera.switch")}</button>--\x3e\n        <button\n          class="camera-click uppload-button uppload-button--cta"\n          style="background: ${this.color}"\n        >${t("services.camera.button")}</button>\n      </footer>\n      <button class="need-help-link"><span>${t("needHelp")}</span aria-hidden="true"><span>?</span></button>\n    `,this.stop=()=>{this.stream&&this.stream.getTracks().forEach(t=>t.stop())},this.handlers=t=>{this.waiting=!0,this.update(t);this.startStream(t,{audio:!1,video:{width:1280,height:1280}});const e=t.uppload.container.querySelector(".camera-click");e&&Object(n.e)(e,"click",this.clickPhoto.bind(this,t));const i=t.uppload.container.querySelector(".camera-click");i&&Object(n.e)(i,"click",this.switchCamera.bind(this,t));const a=t.uppload.container.querySelector(".need-help-link");a&&Object(n.e)(a,"click",()=>t.showHelp("/services/camera"))}}update(t){const e=t.uppload.container.querySelector(".camera-waiting");e&&(e.style.display="none",e.style.opacity="0");const i=t.uppload.container.querySelector(".camera-error");i&&(i.style.display="none",i.style.opacity="0");const a=t.uppload.container.querySelector(".camera-success");a&&(a.style.display="none",a.style.opacity="0");const n=t.uppload.container.querySelector(".service-footer");n&&(n.style.display="none",n.style.opacity="0"),this.gotError?i&&(i.style.display="",i.style.opacity="1"):this.waiting?e&&(e.style.display="",e.style.opacity="1"):(a&&(a.style.display="",a.style.opacity="1"),n&&(n.style.display="",n.style.opacity="1"))}switchCamera(t){this.frontCamera=!this.frontCamera;const e={audio:!1,video:{width:1280,height:1280,facingMode:this.frontCamera?"user":"environment"}};this.startStream(t,e)}clickPhoto(t){this.canvas=document.createElement("canvas");const e=t.uppload.container.querySelector("video.camera-stream");if(!e)return;if(!this.stream)return;const i=e.getBoundingClientRect();let a=i.width,s=i.height;this.stream.getTracks().forEach(t=>{const e=t.getSettings();e.width&&(a=e.width),e.height&&(s=e.height)}),this.canvas.width=a,this.canvas.height=s;const o=this.canvas.getContext("2d");o&&(o.clearRect(0,0,this.canvas.width,this.canvas.height),o.drawImage(e,0,0,a,s),Object(n.a)(this.canvas).then(e=>t.next(Object(r.a)(e,`camera-photo-${Math.random().toString(36).slice(2)}.png`,"image/png",new Date))))}startStream(t,e){this.stop(),window.navigator.mediaDevices.getUserMedia(e).then(e=>{this.stream=e;const i=t.uppload.container.querySelector("video.camera-stream");i&&(i.srcObject=e,Object(n.e)(i,"loadedmetadata",()=>i.play()),Object(n.c)(t,i))}).catch(()=>{this.gotError=!0}).then(()=>{this.waiting=!1,this.update(t)})}}},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));var a=i(17),n=i(4),r=i(12);class s extends a.a{constructor({mimeTypes:t,maxFileSize:e}={}){super(),this.name="local",this.icon='<svg aria-hidden="true" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg"><g fill="#000" fill-rule="nonzero"><path d="M177 56L125 4l-3-2v57h57c0-2-1-3-2-3z"/><path d="M173 113h8V75h-66c-5 0-8-4-8-8V1H27c-4 0-8 4-8 8v184c0 4 4 8 8 8h65v-8c0-45 36-80 81-80z"/><path d="M173 128c-36 0-65 29-65 64s29 64 65 64c35 0 64-29 64-64s-29-64-64-64zm27 63h-14v33c0 2-2 3-4 3h-20c-2 0-3-1-3-3v-33h-14c-3 0-5-3-3-5l28-30c1-2 3-2 5 0l27 30c2 2 1 5-2 5z"/></g></svg>',this.color="#34495e",this.mimeTypes=["image/gif","image/jpeg","image/jpg","image/png"],this.maxFileSize=1/0,this.template=t=>`<div class="drop-area">\n      <div>${t.translate("services.local.drop")}</div>\n      <em>${t.translate("services.local.or")}</em>\n      <button class="uppload-button uppload-button--cta" style="background: ${this.color}">${t.translate("services.local.button")}</button>\n    </div>\n      <div class="alternate-input">\n        <input type="file" accept="${this.mimeTypes.join()}"${t.uppload.settings.multiple?" multiple":""}></div><button class="need-help-link"><span>${Object(r.b)("needHelp")}</span aria-hidden="true"><span>?</span></button>`,this.handlers=t=>{const e=t.uppload.container.querySelector(".drop-area");e&&(Object(n.e)(e,"drop",e=>this.dropHandler(t,e)),Object(n.e)(e,"dragover",e=>this.dragHandler(t,e)),Object(n.e)(e,"dragend",e=>this.dragStop(t,e)),Object(n.e)(e,"dragexit",e=>this.dragStop(t,e)),Object(n.e)(e,"dragleave",e=>this.dragStop(t,e)),Object(n.e)(e,"click",e=>this.fileSelect(t,e)));const i=t.uppload.container.querySelector(".alternate-input input[type=file]");i&&Object(n.e)(i,"change",e=>this.getFile(t,e));const a=t.uppload.container.querySelector(".need-help-link");a&&Object(n.e)(a,"click",()=>t.showHelp("/services/local"))},t&&(this.mimeTypes=t),e&&(this.maxFileSize=e)}getFile(t,e){e.preventDefault();const i=e.target.files;let a=null;if(i){if(t.uppload.settings.multiple&&i.length>1)return t.uploadMultiple(Array.from(i));for(let e=0;e<i.length;e++){const n=i[e];-1!==this.mimeTypes.indexOf(n.type)&&(n.size<this.maxFileSize?a=n:t.handle(new Error(t.translate("errors.file_too_large",this.maxFileSize+" bytes"))))}}a&&a&&t.next({blob:a,size:a.size,type:a.type,lastModified:a.lastModified?new Date(a.lastModified):void 0,name:a.name})}fileSelect(t,e){const i=t.uppload.container.querySelector(".alternate-input input[type=file]");i&&i.click()}dragStop(t,e){const i=t.uppload.container.querySelector(".drop-area");i&&i.classList.remove("drop-area-active")}dragHandler(t,e){e.preventDefault();const i=t.uppload.container.querySelector(".drop-area");i&&i.classList.add("drop-area-active")}dropHandler(t,e){e.preventDefault(),this.dragStop(t,e);let i=null;if(e.dataTransfer&&e.dataTransfer.items)for(let a=0;a<e.dataTransfer.items.length;a++){const n=e.dataTransfer.items[a];"file"===n.kind&&-1!==this.mimeTypes.indexOf(n.type)&&(i=n.getAsFile(),(!i||i.size>this.maxFileSize)&&(i=null,t.handle(new Error(t.translate("errors.file_too_large",this.maxFileSize+" bytes")))))}i&&i&&t.next({blob:i,size:i.size,type:i.type,lastModified:i.lastModified?new Date(i.lastModified):void 0,name:i.name})}}},function(t,e,i){"use strict";var a=i(23);a.a},function(t,e,i){"use strict";var a=i(23);a.a},function(t,e,i){"use strict";var a=i(23);a.a},function(t,e,i){"use strict";var a=i(23);a.a},function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var a=i(8);class n extends a.a{constructor(){super(...arguments),this.name="url",this.icon='<svg aria-hidden="true" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg"><g fill="#000" fill-rule="nonzero"><path d="M200 151l36-36a67 67 0 10-95-95L89 72a67 67 0 0012 105l28-28a31 31 0 01-14-51l52-52a31 31 0 0143 43l-15 15c6 15 8 31 5 47z"/><path d="M56 105l-36 36a67 67 0 1095 95l52-52a67 67 0 00-12-105l-28 28a31 31 0 0114 51l-52 52a31 31 0 01-43-43l15-15c-6-15-8-31-5-47z"/></g></svg>',this.color="#8e44ad"}}},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";var a=i(8);a.a},function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var a=i(18),n=i(27),r=i.n(n),s=i(4);class o extends a.a{constructor({aspectRatio:t,aspectRatioOptions:e,hideAspectRatioSettings:i,autoCropArea:a,viewMode:n}={}){super(),this.name="crop",this.icon='<svg aria-hidden="true" viewBox="0 0 256 256" xmlns="http://www.w3.org/2000/svg"><path d="M74 0v182h134v-25h-26V74H99V48h96c4 0 7 1 9 4 3 2 4 5 4 9v121h48v26h-48v48h-26v-48H61a13 13 0 01-13-13V74H0V48h48V0h26z" fill="#000" fill-rule="nonzero"/></svg>',this.aspectRatio=NaN,this.hideAspectRatioSettings=!1,this.aspectRatioOptions={free:NaN,square:1,"16:9":16/9},this.autoCropArea=1,this.viewMode=1,this.originalFile={blob:new Blob},this.template=({file:t,translate:e})=>{const i=URL.createObjectURL(t.blob);return this.originalFile=t,`\n      <div class="uppload-cropping-element">\n        <img style="width: 20px" alt="" src="${i}">\n      </div>\n      ${this.aspectRatio||this.hideAspectRatioSettings?"":`<div class="uppload-actions">\n        ${Object.keys(this.aspectRatioOptions).map((t,i)=>`\n          <input value="${this.aspectRatioOptions[t]}" data-name="${t}" name="crop-aspect-ratio" type="radio"${i?"":" checked"} id="crop-aspect-ratio-${t}">\n          <label for="crop-aspect-ratio-${t}">${e("effects.crop.aspectRatios."+t)||t}</label>`).join("")}\n      </div>`}\n    `},this.handlers=t=>{const e=t.uppload.container.querySelector(".uppload-cropping-element img"),i=this.originalFile,a=i.type&&-1!==["image/jpeg","image/webp"].indexOf(i.type)?i.type:"image/png";e&&Object(s.c)(t,e).then(()=>{const n=new r.a(e,{aspectRatio:this.aspectRatio,autoCropArea:this.autoCropArea,viewMode:this.viewMode,ready(){Object(s.a)(n.getCroppedCanvas(),a).then(e=>{i.blob=e,t.next(i)})},cropend(){Object(s.a)(n.getCroppedCanvas(),a).then(e=>{i.blob=e,t.next(i)})}});t.uppload.container.querySelectorAll("input[name='crop-aspect-ratio']").forEach(e=>{Object(s.e)(e,"change",()=>{const e=t.uppload.container.querySelector("input[name='crop-aspect-ratio']:checked");e&&(n.setAspectRatio(this.aspectRatioOptions[e.getAttribute("data-name")||"free"]),Object(s.a)(n.getCroppedCanvas(),a).then(e=>{i.blob=e,t.next(i)}))})})})},t&&(this.aspectRatio=t),e&&(this.aspectRatioOptions=e),a&&(this.autoCropArea=a),n&&(this.viewMode=n),i&&(this.hideAspectRatioSettings=i)}}},function(t,e,i){"use strict";var a=i(18);i(27),i(4);a.a},function(t,e,i){"use strict";var a=i(18);i(4);a.a},function(t,e,i){"use strict";var a=i(18);i(4);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";var a=i(14);a.a},function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));const a={upload:"Upload",cancel:"Cancel",close:"Close",uploading:"Uploading...",uploaded:"Uploaded",fetching:"Getting your image from $1$...",poweredBy:"Powered by $1$",needHelp:"Need help?",units:{px:"px","%":"%",deg:"°"},errors:{response_not_ok:"We got an error fetching this file",unable_to_search:"We got an error searching",invalid_service_url:"This is not $A$ $1$ URL",invalid_url:"This URL seems to be invalid",upload_aborted:"Your upload was cancelled",upload_error:"We got an error uploading this file",file_type_not_allowed:"This file type is not allowed",file_too_large:"Your file should be smaller than $1$"},help:{loading:"Loading help...",close:"Close help"},services:{default:{heading:"Select an image"},local:{title:"Choose file",button:"Select a file",or:"or",drop:"Drop files here"},camera:{title:"Camera",button:"Click photo",switch:"Switch camera",waiting:"Waiting for permission...",unableToRead:"We're not able to read your camera's video. This may be because you didn't grant the required permission, or because your device doesn't support camera access."},microlink:{button:"Import from $1$",label:"$1$ $2$ URL",placeholder:"Enter $A$ $1$ $2$ URL",type:"post"},url:{title:"Direct URL",label:"Image URL",placeholder:"Enter an image URL"},instagram:{title:"Instagram"},facebook:{title:"Facebook"},flickr:{title:"Flickr",type:"photo"},ninegag:{title:"9GAG",type:"photo"},deviantart:{title:"DeviantArt"},artstation:{title:"ArtStation"},twitter:{title:"Twitter",type:"image tweet"},pinterest:{title:"Pinterest",type:"pin"},flipboard:{title:"Flipboard",type:"article"},fotki:{title:"Fotki",type:"photo"},linkedin:{title:"LinkedIn"},reddit:{title:"Reddit"},tumblr:{title:"Tumblr"},weheartit:{title:"We Heart It"},screenshot:{title:"Screenshot",button:"Take screenshot",label:"Webpage URL",placeholder:"Enter a webpage URL",loading:"Taking a screenshot..."},search:{button:"Search on $1$",label:"Find an image",placeholder:"Search for something",imagesPoweredBy:"Images powered by $1$"},giphy:{title:"GIPHY"},unsplash:{title:"Unsplash"},pixabay:{title:"Pixabay"},pexels:{title:"Pexels"}},effects:{preview:{title:"Preview"},filters:{title:"Filters"},crop:{title:"Crop",aspectRatios:{free:"Free",square:"Square"}},rotate:{title:"Rotate"},flip:{title:"Flip",buttons:{horizontal:"Horizontal",vertical:"Vertical"}},sharpen:{title:"Sharpen"},blur:{title:"Blur"},brightness:{title:"Brightness"},contrast:{title:"Contrast"},grayscale:{title:"Grayscale"},"hue-rotate":{title:"Hue rotate"},invert:{title:"Invert"},saturate:{title:"Saturate"},sepia:{title:"Sepia"}},helper:t=>{for(;-1!==t.indexOf("$A$");){const e=t.indexOf("$A$");t.length>e+3&&(t=-1!==["a","e","i","o","u"].indexOf(t[e+4].toLowerCase())?t.replace("$A$","an"):t.replace("$A$","a"))}return t}}},function(t,e,i){"use strict";i.d(e,"a",(function(){return p}));var a=i(17),n=i(12),r=i(4),s=i(26),o=i(78),c=i.n(o);var l=function(t){return t=t||Object.create(null),{on:function(e,i){(t[e]||(t[e]=[])).push(i)},off:function(e,i){t[e]&&t[e].splice(t[e].indexOf(i)>>>0,1)},emit:function(e,i){(t[e]||[]).slice().map((function(t){t(i)})),(t["*"]||[]).slice().map((function(t){t(e,i)}))}}},h=i(16);class d extends a.a{constructor(){super(...arguments),this.name="default",this.invisible=!0,this.template=()=>`<p>${Object(n.b)("services.default.heading")}</p>`}}class u extends a.a{constructor(){super(...arguments),this.name="uploading",this.invisible=!0,this.template=()=>`<div class="uppload-loader">\n  <div></div>\n    <p class="uppload-loader-text">${Object(n.b)("uploading")}<span class="progress"></span></p>\n  </div>`}}class p{constructor(t){this.services=[new d,new u],this.effects=[],this.isOpen=!1,this.activeService="default",this.activeEffect="",this.file={blob:new Blob},this.lang={},this.emitter=l(),this.uploadProgress=0,this.inline=!1,this.transitionDuration=300,this.settings={},this.updateSettings(t||{});const e=document.createElement("div");this.renderContainer(),e.classList.add("uppload-container");const i=document.body;i&&i.appendChild(e),this.container=e,this.focusTrap=c()(this.container,{initialFocus:()=>this.container.querySelector("button")}),requestAnimationFrame(()=>this.update()),this.emitter.on("processing",()=>{const t=this.container.querySelector(".processing-loader");t&&t.classList.add("visible")}),this.emitter.on("process",()=>{const t=this.container.querySelector(".processing-loader");t&&t.classList.remove("visible")})}updateSettings(t){this.settings=Object.assign(Object.assign({},this.settings),t),this.emitter.emit("settingsUpdated",t),t.lang&&Object(n.a)(t.lang),t.defaultService&&(this.activeService=t.defaultService),t.lang&&(this.lang=t.lang),t.transitionDuration&&(this.transitionDuration=t.transitionDuration),t.uploader&&(this.uploader=t.uploader),this.inline=!!t.inline,this.update()}ready(){this.settings.value&&this.bind(this.settings.value),this.renderContainer(),this.emitter.emit("ready")}bind(t){if(this.settings.bind){Object(r.d)(this.settings.bind).forEach(e=>{"IMG"===e.nodeName?e.setAttribute("src",t):e.setAttribute("value",t)}),this.emitter.emit("bind")}}use(t){Array.isArray(t)?t.forEach(t=>this.install(t)):this.install(t)}remove(t){this.services=this.services.filter(e=>e.name!==t),this.effects=this.effects.filter(e=>e.name!==t),this.update(),this.emitter.emit("remove",t)}updatePlugins(t){const e=t(this.services),i=e.filter(t=>"service"===t.type),a=!!i.filter(t=>"default"===t.name).length;!!i.filter(t=>"uploading"===t.name).length||i.unshift(new u),a||i.unshift(new d),this.services=i,this.effects=e.filter(t=>"effect"===t.type),this.update()}install(t){if(t.supports())if("service"===t.type){!!this.services.filter(e=>e.name===t.name).length||this.services.push(t),this.ready()}else if("effect"===t.type){!!this.effects.filter(e=>e.name===t.name).length||this.effects.push(t),this.ready()}}modalOpen(){return this.isOpen}open(){if(this.isOpen)return;this.isOpen=!0,this.file={blob:new Blob},this.activeService="default",this.activeEffect="";const t=this.container.querySelector(`input[type=radio][value='${this.activeService}']`);t&&t.setAttribute("checked","checked"),this.container.style.transition=this.transitionDuration+"ms",this.container.style.opacity="0",this.update();let e=this.settings.defaultService;3===this.services.length&&this.navigate(this.services[2].name),e&&this.navigate(e),Object(r.e)(document.body,"keyup",t=>{"Escape"===t.key&&this.open&&this.close()}),setTimeout(()=>{this.container.style.opacity="1"},1),this.emitter.emit("open")}close(){this.isOpen&&(this.stopCurrentService(),this.isOpen=!1,this.emitter.emit("close"),this.container.style.opacity="0",setTimeout(()=>this.update(),this.transitionDuration))}toggle(){this.modalOpen()?this.close():this.open()}update(){if(!this.container)return;this.hideHelp(),this.settings.customClass&&this.container.classList.add(this.settings.customClass),this.inline&&this.container.classList.add("uppload-inline");const t=this.container.querySelector(".uppload-active-container");t&&(t.innerHTML=this.render());const e=this.container.querySelector("aside");e&&"default"!==this.activeService&&!this.activeEffect&&(e.style.display="block");const i=this.container.querySelector(".effects-nav");e&&i&&this.activeEffect?(i.style.display="",e.style.display="none"):e&&i&&"default"===this.activeService?(e.style.display="none",i.style.display="none"):e&&i&&(e.style.display="",i.style.display="none");const a=this.container.querySelector(".uppload-effect");a&&(a.style.display=this.activeEffect?"":"none"),window.requestAnimationFrame(()=>this.handlers()),this.isOpen?(this.container.classList.add("visible"),this.focusTrap.activate()):(this.container.classList.remove("visible"),this.focusTrap.deactivate());const n=this.container.querySelector("footer.effects-nav .effects-tabs");if(n){const t=n.parentElement;if(t){let e=0;t.querySelectorAll(".effects-continue").forEach(t=>{const i=t.getBoundingClientRect();e+=i.width});const i=t.getBoundingClientRect();n.style.width=i.width-e+"px"}}const s=this.container.querySelector("aside");s&&3===this.services.length&&s.classList.add("uppload-services--single");const o=this.container.querySelector(".uppload-help");o&&(o.classList.remove("visible"),Object(r.e)(o,"click",()=>this.hideHelp()))}getNavbar(t=!1){return`<${t?"nav":"div"} class="uppload-services">\n      ${this.services.filter(t=>!t.invisible).map(e=>`<div data-uppload-service="${e.name}" class="uppload-service-name">\n          ${t?`<input type="radio" id="uppload-service-radio-${e.name}" value="${e.name}" name="uppload-radio">`:""}\n          <${t?`label for="uppload-service-radio-${e.name}"`:"button"} data-uppload-service="${e.name}">\n            ${0===e.icon.indexOf("http")?`<img class="service-icon" alt="" src="${e.icon}">`:Object(s.a)(e.icon,e)}\n            <span>${this.lang.services&&this.lang.services[e.name]&&this.lang.services[e.name].title?this.lang.services[e.name].title:e.name}</span>\n          </${t?"label":"button"}>\n        </div>`).join("")}\n    </${t?"nav":"div"}>`}getEffectsNavbar(){return`<div class="effects-continue">\n    <button class="effects-continue--cancel">${Object(n.b)("cancel")}</button>\n  </div><div class="effects-tabs"><div class="effects-tabs-flow">\n      ${this.effects.map(t=>`\n      <input type="radio" id="uppload-effect-radio-${t.name}" value="${t.name}" name="uppload-effect-radio">\n        <label for="uppload-effect-radio-${t.name}">\n          ${0===t.icon.indexOf("http")?`<img class="effect-icon" alt="" src="${t.icon}">`:Object(s.a)(t.icon,t)}\n          <span>${this.lang.effects&&this.lang.effects[t.name]&&this.lang.effects[t.name].title?this.lang.effects[t.name].title:t.name}</span>\n        </label>\n      `).join("")}\n      </div></div><div class="effects-continue">\n        <button class="effects-continue--upload">${Object(n.b)("upload")}</button>\n      </div>`}renderContainer(){this.container&&(this.container.innerHTML=`\n      <div class="uppload-modal">\n        <div class="processing-loader"></div>\n        <aside style="display: none">\n          ${this.getNavbar(!0)}\n        </aside>\n        <section>\n          ${this.error?`<div class="uppload-error">${this.error}</div>`:""}\n          <div class="uppload-active-container"></div>\n          <footer style="display: none" class="effects-nav">${this.getEffectsNavbar()}</footer>\n        </section>\n        <div class="uppload-help-loading">\n          <div class="uppload-loader">\n            <div></div>\n            <p class="uppload-loader-text">${Object(n.b)("help.loading")}</p>\n          </div>\n        </div>\n        <div class="uppload-help">\n          <div><button><span>${Object(n.b)("help.close")}</span><span aria-hidden="true">&times;</span></button></div>\n          <iframe></iframe>\n        </div>\n      </div>\n      <div class="uppload-modal-bg">\n        <button class="uppload-close" aria-label="${Object(n.b)("close")}">&times;</button>\n      </div>\n    `)}render(){return`\n      ${this.error?`<div class="uppload-error">${this.error}</div>`:""}\n      ${this.activeEffect?`<div class="uppload-effect uppload-effect--${this.activeEffect||"none"}">\n      ${this.activeEffect&&this.file?this.renderActiveEffect(this.file):""}\n    </div>`:`<div class="uppload-service uppload-service--${this.activeService}">\n      ${this.activeEffect&&this.file?"":this.renderActiveService()}\n      ${"default"===this.activeService?this.getNavbar():""}\n    </div>`}`}renderActiveService(){const t=this.services.filter(t=>t.name===this.activeService);if(t.length){const e=t[0];return requestAnimationFrame(()=>{"function"==typeof e.handlers&&e.handlers({next:this.next.bind(this),upload:this.upload.bind(this),uploadMultiple:this.uploadMultiple.bind(this),handle:this.handle.bind(this),showHelp:this.showHelp.bind(this),uppload:this,translate:n.b})}),""+("function"==typeof e.template?e.template({translate:n.b,uppload:this}):"")}}renderActiveEffect(t){const e=this.effects.filter(t=>t.name===this.activeEffect);if(e.length){const i=e[0];return requestAnimationFrame(()=>{"function"==typeof i.handlers&&i.handlers({next:this.next.bind(this),upload:this.upload.bind(this),uploadMultiple:this.uploadMultiple.bind(this),handle:this.handle.bind(this),showHelp:this.showHelp.bind(this),uppload:this,translate:n.b})}),`\n        <div class="active-effect-container">${"function"==typeof i.template?i.template({file:t,translate:n.b}):""}</div>\n      `}}uploadMultiple(t){return this.emitter.emit("before-upload"),new Promise(e=>{this.navigate("uploading"),this.uploader&&"function"==typeof this.uploader?this.uploader(t,this.updateProgress.bind(this)).then(t=>{this.navigate("default"),e(t),this.emitter.emit("upload",t),this.close()}).catch(t=>this.handle(t)):this.handle(new Error("no-uploader"))})}hideHelp(){const t=this.container.querySelector(".uppload-help"),e=this.container.querySelector(".uppload-help-loading"),i=this.container.querySelector("aside"),a=this.container.querySelector("section");e&&e.classList.remove("visible"),t&&t.classList.remove("visible"),i&&(i.style.display=""),a&&(a.style.display=""),this.emitter.emit("hide-help")}showHelp(t){this.emitter.emit("help",t);const e=this.container.querySelector("aside");e&&(e.style.display="none");const i=this.container.querySelector("section");i&&(i.style.display="none");const a=this.container.querySelector(".uppload-help-loading");a&&a.classList.add("visible");const n=this.container.querySelector(".uppload-help");if(n){const e=n.querySelector("iframe");if(e){e.setAttribute("src","https://uppload.js.org/help"+t);let i=!1;const s=()=>{i=!0,n.classList.add("visible"),a&&a.classList.remove("visible")};Object(r.e)(e,"load",s),Object(r.e)(e,"error",()=>{i=!0,this.hideHelp()})}}}next(t){if(this.emitter.emit("next",t),this.file=t,this.activeEffect);else{if(!this.effects.length||!t.type||0!==t.type.indexOf("image/"))return this.upload(Object(h.b)(t));this.activeEffect=this.effects[0].name,this.update()}const e=this.container.querySelector(`input[name='uppload-effect-radio'][value='${this.activeEffect}']`);e&&e.setAttribute("checked","checked")}compress(t){return this.settings.compressionFromMimes&&-1===this.settings.compressionFromMimes.indexOf(t.type)?new Promise(e=>e(t)):"function"==typeof this.settings.compressor?this.settings.compressor(t):Object(r.b)(t,this.settings)}upload(t){return this.emitter.emit("before-upload",t),new Promise((e,i)=>{this.navigate("uploading");let a=Object(h.a)(t);try{"string"==typeof t.name&&(a=Object(h.a)(t,t.name,t.type,new Date(t.lastModified)))}catch(t){}this.uploader&&"function"==typeof this.uploader?this.compress(t).then(t=>(this.settings.compression&&this.emitter.emit("compress",t),t)).then(t=>(a.blob=t,Object(h.b)(a))).then(t=>this.uploader(t,this.updateProgress.bind(this))).then(t=>{this.bind(t),this.navigate("default"),e(t),this.emitter.emit("upload",t),this.close()}).catch(t=>this.handle(t)):i("no-uploader")})}handle(t){this.error=Object(n.b)(t.message)||t.message,this.emitter.emit("error",this.error),this.update(),"uploading"===this.activeService&&this.navigate("default"),setTimeout(()=>{this.error=void 0,this.update()},4e3)}handlers(){const t=()=>this.open(),e=()=>this.close();this.container.querySelectorAll(".uppload-service--default .uppload-service-name button").forEach(t=>{Object(r.e)(t,"click",e=>{const i=t.getAttribute("data-uppload-service");if(i){this.navigate(i);const t=this.container.querySelector(`[data-uppload-service="${i}"]`);if(t&&t.parentElement){let e=0,i=0;const a=t.getBoundingClientRect(),n=t.parentElement.getBoundingClientRect();e=a.top-n.top,i=a.left-n.left;const r=t.parentElement.parentElement;try{r&&r.scrollTo(i,e)}catch(t){}}}const a=this.container.querySelector(`input[type=radio][value='${i}']`);return a&&a.setAttribute("checked","checked"),e.preventDefault(),!1})});this.container.querySelectorAll(".uppload-services input[type='radio']").forEach(t=>{Object(r.e)(t,"change",t=>{const e=this.container.querySelector("[name='uppload-radio']:checked");if(!e)return;const i=e.value;this.navigate(i)})});this.container.querySelectorAll(".effects-nav input[type='radio']").forEach(t=>{Object(r.e)(t,"change",t=>{const e=this.container.querySelector("[name='uppload-effect-radio']:checked");if(!e)return;const i=e.value;this.activeEffect=i,this.update()})});const i=this.container.querySelector(".uppload-modal-bg"),a=this.container.querySelector(".uppload-close");if(i&&!this.settings.disableModalClickClose?Object(r.e)(i,"click",e):a&&Object(r.e)(a,"click",e),this.settings.call){Object(r.d)(this.settings.call).forEach(e=>{Object(r.e)(e,"click",t)})}const n=this.container.querySelector(".effects-continue--cancel");n&&Object(r.e)(n,"click",()=>{this.file={blob:new Blob},this.activeService="default",this.activeEffect="",this.update()});const s=this.container.querySelector(".effects-continue--upload");s&&Object(r.e)(s,"click",()=>{this.file&&(this.activeService="",this.activeEffect="",this.upload(Object(h.b)(this.file)))})}stopCurrentService(){const t=this.services.filter(t=>t.name===this.activeService);if(t.length){t[0].stop()}}navigate(t){if(!this.services.filter(e=>e.name===t).length)throw new Error("invalid-service");this.stopCurrentService(),this.activeService=t,this.update();const e=this.container.querySelector(".uppload-active-container input, .uppload-active-container button");e&&e.focus()}on(t,e){return this.emitter.on(t,e)}off(t,e){return this.emitter.off(t,e)}updateProgress(t){this.uploadProgress=t;const e=this.container.querySelector(".uppload-loader-text .progress");e&&(e.innerHTML=parseInt(t.toString())+"%"),this.emitter.emit("progress",this.updateProgress)}}},,,function(t,e,i){var a,n,r=i(96),s=i(97),o=(n=[],{activateTrap:function(t){if(n.length>0){var e=n[n.length-1];e!==t&&e.pause()}var i=n.indexOf(t);-1===i||n.splice(i,1),n.push(t)},deactivateTrap:function(t){var e=n.indexOf(t);-1!==e&&n.splice(e,1),n.length>0&&n[n.length-1].unpause()}});function c(t){return setTimeout(t,0)}t.exports=function(t,e){var i=document,n="string"==typeof t?i.querySelector(t):t,l=s({returnFocusOnDeactivate:!0,escapeDeactivates:!0},e),h={firstTabbableNode:null,lastTabbableNode:null,nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1},d={activate:function(t){if(h.active)return;x(),h.active=!0,h.paused=!1,h.nodeFocusedBeforeActivation=i.activeElement;var e=t&&t.onActivate?t.onActivate:l.onActivate;e&&e();return p(),d},deactivate:u,pause:function(){if(h.paused||!h.active)return;h.paused=!0,f()},unpause:function(){if(!h.paused||!h.active)return;h.paused=!1,x(),p()}};return d;function u(t){if(h.active){clearTimeout(a),f(),h.active=!1,h.paused=!1,o.deactivateTrap(d);var e=t&&void 0!==t.onDeactivate?t.onDeactivate:l.onDeactivate;return e&&e(),(t&&void 0!==t.returnFocus?t.returnFocus:l.returnFocusOnDeactivate)&&c((function(){var t;k((t=h.nodeFocusedBeforeActivation,m("setReturnFocus")||t))})),d}}function p(){if(h.active)return o.activateTrap(d),a=c((function(){k(g())})),i.addEventListener("focusin",b,!0),i.addEventListener("mousedown",v,{capture:!0,passive:!1}),i.addEventListener("touchstart",v,{capture:!0,passive:!1}),i.addEventListener("click",w,{capture:!0,passive:!1}),i.addEventListener("keydown",y,{capture:!0,passive:!1}),d}function f(){if(h.active)return i.removeEventListener("focusin",b,!0),i.removeEventListener("mousedown",v,!0),i.removeEventListener("touchstart",v,!0),i.removeEventListener("click",w,!0),i.removeEventListener("keydown",y,!0),d}function m(t){var e=l[t],a=e;if(!e)return null;if("string"==typeof e&&!(a=i.querySelector(e)))throw new Error("`"+t+"` refers to no known node");if("function"==typeof e&&!(a=e()))throw new Error("`"+t+"` did not return a node");return a}function g(){var t;if(!(t=null!==m("initialFocus")?m("initialFocus"):n.contains(i.activeElement)?i.activeElement:h.firstTabbableNode||m("fallbackFocus")))throw new Error("Your focus-trap needs to have at least one focusable element");return t}function v(t){n.contains(t.target)||(l.clickOutsideDeactivates?u({returnFocus:!r.isFocusable(t.target)}):l.allowOutsideClick&&l.allowOutsideClick(t)||t.preventDefault())}function b(t){n.contains(t.target)||t.target instanceof Document||(t.stopImmediatePropagation(),k(h.mostRecentlyFocusedNode||g()))}function y(t){if(!1!==l.escapeDeactivates&&function(t){return"Escape"===t.key||"Esc"===t.key||27===t.keyCode}(t))return t.preventDefault(),void u();(function(t){return"Tab"===t.key||9===t.keyCode})(t)&&function(t){if(x(),t.shiftKey&&t.target===h.firstTabbableNode)return t.preventDefault(),void k(h.lastTabbableNode);if(!t.shiftKey&&t.target===h.lastTabbableNode)t.preventDefault(),k(h.firstTabbableNode)}(t)}function w(t){l.clickOutsideDeactivates||n.contains(t.target)||l.allowOutsideClick&&l.allowOutsideClick(t)||(t.preventDefault(),t.stopImmediatePropagation())}function x(){var t=r(n);h.firstTabbableNode=t[0]||g(),h.lastTabbableNode=t[t.length-1]||g()}function k(t){t!==i.activeElement&&(t&&t.focus?(t.focus(),h.mostRecentlyFocusedNode=t,function(t){return t.tagName&&"input"===t.tagName.toLowerCase()&&"function"==typeof t.select}(t)&&t.select()):k(g()))}}},,,,,,,,,,,,,,,,,function(t,e,i){"use strict";i.r(e);var a=i(25);$(document).ready((function(){var t,e=window.lidlRTO,i=window.common,n=window.actions,r=new window.profile.Profile(window.exploreUserId),s=new lidl.Observer((function(e){t=e}));r.getUserAndSubscribe(s).then((function(s){!function(s){window.DockerElement.addDockerSubPage("user",s),t=s;var o=window.exploreUserId;i.DropdownMenu(".dropdown-menu","click");var c={userid:o,callback:{onConfirm:function(){n.deleteUser(o)}}},l=e.objectManager.createNewObjectToken();const h=new lidl.Dialog(l,".userDelete","confirmDelete",{title:"Nutzer löschen",message:"U sure bro?",titleArg:"",messageArg:""},c);e.objectManager.addObject(h,l);const d={userid:o,callback:{onConfirm:function(t){n.removeDBKey(o,t.event.target.dataset.attributekey,{},(function(){$("#useritem-"+i.escapeSelector(t.event.target.dataset.attributekey)).remove()}))}}};var u=e.objectManager.createNewObjectToken();const p=new lidl.Dialog(u,".useredit-removeItemBtn","removeDBKey",{title:"Attribut löschen",message:"Folgendes Attribut wird gelöscht:",titleArg:"",messageArg:""},d);e.objectManager.addObject(p,u);const f=new a.Uppload({lang:a.en,call:".changeProfilePicture",defaultService:"local",uploader:Object(a.xhrUploader)({endpoint:"/api/v1/usermod/"+o+"/uploadUserImage",fileKeyName:"image",method:"POST"})});f.use([new a.Local,new a.Camera,new a.URL]),f.use([new a.Crop({aspectRatio:1})]),f.on("upload",(function(){const t=$(".userProfileImage");let e;$(t).each((function(t){e=$(this).attr("src"),$(this).attr("src",e+"?t="+(new Date).getTime())}))}));var m=new i.Sidebar("wrapper",{title:"Test"});let g=document.getElementById("qualification-list");new i.ScrollableList(g,"qualification",s.qualifications,{},{listItem:{onClick:function(t){t.preventDefault();var a=t.currentTarget;m.addContent("UserUpdateQualification",{userid:o,key:a.dataset.key,keyId:a.dataset.keyid,qualificationId:a.dataset.keyid,callback:{onConfirm:function(t,e,i){var r={isArray:!0,noIndex:!1,keyId:a.dataset.keyId};n.insertDBKey(t,e,i,r,(function(){}))},onDelete:function(t,a,r){var s={isArray:!0};const o={title:"Qualifikation löschen",message:"Folgende Qualifikation wird gelöscht: "+r.qualification.name,titleArg:"",messageArg:""};var c=e.objectManager.createNewObjectToken();const l={userid:t,callback:{onConfirm:function(o){n.removeDBKey(t,a,r,s,(function(){$("#qualId"+i.escapeSelector(r.id)).remove()})),e.objectManager.removeObject(c),m.hide()}}},h=new lidl.Dialog(c,null,"removeDBKey",o,l);e.objectManager.addObject(h,c),h.openDialog()}}}),m.show()}}});$(".useredit-addItemBtn").on("click",(function(t){t.preventDefault(),m.addContent("UserAddDBKey",{userid:o,callback:{onConfirm:function(t,e,i,a){n.insertDBKey(t,e,i,a)}}}),m.show()})),$(".useredit-addContactItemBtn").on("click",(function(t){t.preventDefault();m.addContent("UserAddContactDataKey",{userid:o,catKey:this.dataset.catkey,callback:{onConfirm:function(t,e,i,a){a={isArray:!0,noIndex:!0},n.insertDBKey(t,e,i,a)}}}),m.show()})),$(".useredit-addGeneralItemBtn").on("click",(function(t){t.preventDefault();m.addContent("UserAddGeneralDataKey",{userid:o,catKey:this.dataset.catkey,callback:{onConfirm:function(t,e,i,a){n.insertDBKey(t,e,i,a)}}}),m.show()})),$(".useredit-addQualificationBtn").on("click",(function(t){t.preventDefault();m.addContent("UserAddQualification",{userid:o,catKey:this.dataset.catkey,callback:{onConfirm:function(t,e,i,a){a={isArray:!0,noIndex:!0},n.insertDBKey(t,e,i,a,(function(){}))}}}),m.show()})),$(".userkey-entry").on("click",(function(t){t.preventDefault();m.addContent("UserUpdateDBKey",{userid:o,keyId:this.dataset.keyid,key:this.dataset.key,catKey:this.dataset.catkey,subKey:this.dataset.subkey,combinedKey:this.dataset.combinedkey,value:this.dataset.value,isCustomEntry:this.dataset.iscustomentry,callback:{onConfirm:function(e,i,a){n.updateDBKey(e,i,a,{},(function(e){let n=e.result;m.hide(),$(t.currentTarget).find(".userkey-entry-value").html(a.value),$(t.currentTarget).find(".userkey-entry-title").html(a.title),t.currentTarget.dataset.value=a.value,t.currentTarget.dataset.title=a.title,"generalData.firstName"!==i&&"generalData.lastName"!==i||(document.getElementById("userProfileName").innerHTML=n.generalData.firstName.value+" "+n.generalData.lastName.value)}))},onDelete:function(t,a,r){var s={isArray:!0};const o={title:"Eintrag löschen",message:"Folgender Eintrag wird gelöscht: "+r.title,titleArg:"",messageArg:""};var c=e.objectManager.createNewObjectToken();const l={userid:t,callback:{onConfirm:function(o){n.removeDBKey(t,a,r,s,(function(){$("#userkey-"+i.escapeSelector(a)).remove()})),e.objectManager.removeObject(c)}}},h=new lidl.Dialog(c,null,"removeDBKey",o,l);e.objectManager.addObject(h,c),h.openDialog()}}}),m.show()})),$(".usercontact-entry").on("click",(function(a){a.preventDefault();this.dataset.keyid;var s=this.dataset.key,c=i.refJSON(t,s);m.addContent("UserUpdateContactKey",{userid:o,key:s,catKey:this.dataset.catkey,field:c,user:t,type:c.type,default:c.default,callback:{onConfirm:function(t,e,i,n){r.updateDBKey(e,i,n,(function(){m.hide(),$(a.currentTarget).find(".userkey-entry-value").html(i.value),$(a.currentTarget).find(".userkey-entry-title").html(i.title),a.currentTarget.dataset.value=i.value,a.currentTarget.dataset.title=i.title}))},onDelete:function(t,a,r){var s={isArray:!0};const o={title:"Eintrag löschen",message:"Folgender Eintrag wird gelöscht: "+r.title,titleArg:"",messageArg:""};var c=e.objectManager.createNewObjectToken();const l={userid:t,callback:{onConfirm:function(o){n.removeDBKey(t,a,r,s,(function(){$("#userkey-"+i.escapeSelector(a)).remove()})),e.objectManager.removeObject(c)}}},h=new lidl.Dialog(c,null,"removeDBKey",o,l);e.objectManager.addObject(h,c),h.openDialog()}}}),m.show()})),$(".useredit-saveItemBtn").each((function(){const t=e.objectManager.createNewObjectToken();var a=new lidl.Button(t,this,{enabled:!1,classes:{onEnabled:"enabled",onDisabeld:"disabled"}}),n=a.element.dataset.attributekey,r=(a.element.dataset.attributeval,a.element.dataset.confirm,$("#userinp-"+i.escapeSelector(n)));a.addAction("click",action);var s=r;s.on("input",(function(){a.enable()})),s.on("inputReset",(function(){a.disable()})),e.objectManager.addObject(a,t)})),$(".useredit-resetItemBtn").each((function(){const t=e.objectManager.createNewObjectToken();var a=new lidl.Button(t,this,{enabled:!1,classes:{onEnabled:"enabled",onDisabeld:"disabled"}}),n=a.element.dataset.attributekey;a.element.dataset.attributeval;a.addAction("click",(function(){var t=$("#userinp-"+i.escapeSelector(n));t.val(a.element.dataset.attributeval),t.trigger("inputReset"),a.disable()}));var r=$("#userinp-"+i.escapeSelector(n));r.data("resetVal",r.val()),r.on("input",(function(){a.enable()})),r.on("inputReset",(function(t){var e=$(t.target);e.val(e.data("resetVal")),a.disable()})),e.objectManager.addObject(a,t)})),$(".username-change").off("click").on("click",(function(t){t.preventDefault();m.addContent("UserChangeUsername",{userid:o,key:"username",value:this.dataset.value,callback:{onConfirm:function(t,i,a){var r={};var s={userid:t,callback:{onConfirm:function(){n.updateDBKey(t,i,a,r,(function(){location.replace("/unisams/user/edit/"+t)}))}}};l=e.objectManager.createNewObjectToken();const o=new lidl.Dialog(token2,null,"confirmChange",{title:"unisams-Nutzername ändern",message:"Achtung: Anmeldung zum Unisams-System ist danach nur noch mit dem neuen Nutzernamen möglich.",titleArg:"",messageArg:""},s);e.objectManager.addObject(o,l),o.openDialog()},onDelete:function(t,a){var r="qualifications",s={};const o={title:"Eintrag löschen",message:"Folgender Eintrag wird gelöscht: "+a.title,titleArg:"",messageArg:""};var c=e.objectManager.createNewObjectToken();const l={userid:t,callback:{onConfirm:function(o){n.removeDBKey(t,r,a,s,(function(){$("#userkey"+i.escapeSelector(r)).remove()})),e.objectManager.removeObject(c)}}},h=new lidl.Dialog(c,null,"removeDBKey",o,l);e.objectManager.addObject(h,c),h.openDialog()}}}),m.show()}))}(s)})).catch((function(t){console.error("Failed to retrieve user data:"+t)}))}))},function(t,e){var i=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'],a=i.join(","),n="undefined"==typeof Element?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;function r(t,e){e=e||{};var i,r,o,c=[],d=[],u=t.querySelectorAll(a);for(e.includeContainer&&n.call(t,a)&&(u=Array.prototype.slice.apply(u)).unshift(t),i=0;i<u.length;i++)s(r=u[i])&&(0===(o=l(r))?c.push(r):d.push({documentOrder:i,tabIndex:o,node:r}));return d.sort(h).map((function(t){return t.node})).concat(c)}function s(t){return!(!o(t)||function(t){return function(t){return d(t)&&"radio"===t.type}(t)&&!function(t){if(!t.name)return!0;var e=function(t){for(var e=0;e<t.length;e++)if(t[e].checked)return t[e]}(t.ownerDocument.querySelectorAll('input[type="radio"][name="'+t.name+'"]'));return!e||e===t}(t)}(t)||l(t)<0)}function o(t){return!(t.disabled||function(t){return d(t)&&"hidden"===t.type}(t)||function(t){return null===t.offsetParent||"hidden"===getComputedStyle(t).visibility}(t))}r.isTabbable=function(t){if(!t)throw new Error("No node provided");return!1!==n.call(t,a)&&s(t)},r.isFocusable=function(t){if(!t)throw new Error("No node provided");return!1!==n.call(t,c)&&o(t)};var c=i.concat("iframe").join(",");function l(t){var e=parseInt(t.getAttribute("tabindex"),10);return isNaN(e)?function(t){return"true"===t.contentEditable}(t)?0:t.tabIndex:e}function h(t,e){return t.tabIndex===e.tabIndex?t.documentOrder-e.documentOrder:t.tabIndex-e.tabIndex}function d(t){return"INPUT"===t.tagName}t.exports=r},function(t,e){t.exports=function(){for(var t={},e=0;e<arguments.length;e++){var a=arguments[e];for(var n in a)i.call(a,n)&&(t[n]=a[n])}return t};var i=Object.prototype.hasOwnProperty}]);